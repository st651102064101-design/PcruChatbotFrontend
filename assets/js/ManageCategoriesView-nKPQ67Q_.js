import{f as e,I as a,r as l,l as t,e as s,g as i,L as o,H as n,c as r,o as c,a as d,d as u,p,u as v,h as g,z as f,n as m,s as b,G as C,F as h,b as y,t as w,w as k,i as x,K as D,q as I}from"./vue-vendor-CaqZERVf.js";import{_ as P,e as S,b as N,T as F,S as L,i as j,A as B,a as T}from"./index-CjxO0-0y.js";import"./axios-vendor-Dos3PyFQ.js";const M={class:"dashboard-container"},V={class:"main-content"},U={class:"container-fluid"},_={key:0,class:"text-center py-5"},O={key:1},R={class:"header-section my-4"},W={class:"header-top d-flex align-items-center gap-3 mb-3"},$=["aria-label"],q={class:"header-actions d-flex gap-2"},E={class:"search-container-wrapper"},z={class:"search-container"},A={class:"apple-card"},G={class:"table-responsive"},H={class:"table apple-table mb-0"},J=["onClick"],K={class:"ps-4","data-label":""},Q=["onClick"],X={class:"cat-id-cell fw-semibold text-primary","data-label":"CategoriesID"},Y={class:"fw-medium text-dark","data-label":"CategoriesName"},Z={"data-label":"Type"},ee={class:"contact-cell","data-label":"Contact"},ae={key:0},le={key:1,class:"text-muted small"},te={"data-label":"File"},se=["onClick"],ie={key:1,class:"text-muted small"},oe=["onClick"],ne={class:"cat-id-cell ps-4 text-secondary","data-label":"CategoriesID"},re={class:"ps-4 text-dark","data-label":"CategoriesName"},ce={class:"contact-cell","data-label":"Contact"},de={key:0},ue={key:1,class:"text-muted small"},pe={"data-label":"File"},ve=["onClick"],ge={key:1,class:"text-muted small"},fe={key:0},me={class:"d-flex justify-content-between align-items-center p-3 border-top"},be={class:"small text-secondary"},Ce={"aria-label":"Page navigation"},he={class:"pagination pagination-sm mb-0"},ye=["onClick"],we={class:"apple-modal-content"},ke={class:"apple-modal-header"},xe={class:"d-flex flex-column"},De={class:"apple-modal-title"},Ie={class:"apple-modal-subtitle"},Pe={class:"apple-modal-body"},Se={class:"apple-input-group"},Ne={class:"apple-input-group"},Fe={class:"select-wrapper"},Le=["value","disabled"],je={class:"apple-input-group"},Be={class:"input-with-icon"},Te={class:"apple-input-group"},Me={class:"apple-actions"},Ve=["disabled"],Ue={key:0,class:"spinner-border spinner-border-sm me-2"},_e={class:"apple-modal-content"},Oe={class:"apple-modal-body"},Re={class:"upload-text"},We={key:0},$e={key:1,class:"file-selected"},qe={class:"d-flex justify-content-center gap-2 mt-4"},Ee=["disabled"],ze=["disabled"],Ae={class:"apple-actions mt-4"},Ge=["disabled"],He=["disabled"],Je={key:0,class:"spinner-border spinner-border-sm me-2"},Ke={class:"apple-modal-content wide-modal"},Qe={class:"apple-modal-body p-0 d-flex justify-content-center bg-light"},Xe=["src"],Ye={class:"apple-modal-content large-modal",style:{height:"90vh"}},Ze={class:"apple-modal-header py-2"},ea={class:"d-flex align-items-center gap-2"},aa={class:"fw-semibold text-truncate",style:{"max-width":"300px"}},la={class:"d-flex gap-2"},ta=["href"],sa={class:"apple-modal-body p-0 h-100 bg-light position-relative"},ia=["src"],oa={key:1,class:"d-flex flex-column align-items-center justify-content-center h-100"},na=["href"],ra={class:"drawer-body"},ca={class:"drawer-section"},da={class:"drawer-value text-primary fw-bold"},ua={class:"drawer-section"},pa={class:"drawer-value fw-bold text-dark"},va={class:"drawer-section"},ga={class:"drawer-value"},fa={key:0,class:"drawer-section"},ma={class:"drawer-value"},ba={class:"apple-badge-gray"},Ca={class:"drawer-section"},ha={key:0,class:"drawer-value text-dark whitespace-prewrap"},ya={key:1,class:"drawer-value text-muted"},wa={class:"drawer-section"},ka={key:0,class:"drawer-value"},xa={key:1,class:"drawer-value text-muted"},Da={key:1,class:"drawer-section"},Ia={class:"drawer-value"},Pa={class:"apple-badge-green"},Sa=P({__name:"ManageCategoriesView",setup(P){const Sa=e(),{appContext:Na}=a(),{$axios:Fa,$swal:La}=Na.config.globalProperties,{confirmAction:ja,ConfirmModalComponent:Ba}=S(),Ta=l({}),Ma=l("");let Va=null,Ua=null;const _a=l(""),Oa=l({}),Ra=l({sortBy:"id",sortOrder:"asc",status:""}),Wa=[{value:"id",label:"ID"},{value:"name",label:"ชื่อหมวดหมู่"}],$a=[{value:"main",label:"Main",icon:"bi bi-folder-fill",color:"status-blue"},{value:"sub",label:"Sub",icon:"bi bi-folder",color:"status-gray"}],qa=()=>{El.value=1},Ea=l([]),za=l(!0),Aa=l(null),Ga=l(!1),Ha=l(!1),Ja=l(!1),Ka=l(!1),Qa=l(null),Xa=l(!1),Ya=l(!1),Za=l(!1),el=l(!1),al=l(null),ll=l(!1),tl=l({CategoriesName:"",ParentCategoriesID:"",CategoriesPDF:"",Contact:""}),sl=l(""),il=l(""),ol=l(!1),nl=l(null),rl=t(()=>(Ea.value||[]).filter(e=>{const a=String(e.ParentCategoriesID??"").trim(),l=String(e.CategoriesID??"").trim();return!a||a===l}));function cl(){Qa.value=null,Ga.value=!0}function dl(){Ga.value=!1}function ul(){Ja.value=!0}function pl(){Ja.value=!1}function vl(e,a){var l;sl.value=(l=e)?/^https?:\/\//i.test(l)?l:`/uploads/${l}`:"#",il.value=a||"Document",Ka.value=!0}function gl(){Ka.value=!1,sl.value=""}function fl(e){nl.value=e,ol.value=!0}function ml(){ol.value=!1}function bl(){nl.value&&(!async function(e){el.value=!0,al.value=e.CategoriesID,tl.value={CategoriesName:e.CategoriesName||"",ParentCategoriesID:e.ParentCategoriesID||"",CategoriesPDF:e.CategoriesPDF||"",Contact:e.Contact||""};try{const a=await Fa.get(`/categories/crud/single/${encodeURIComponent(e.CategoriesID)}`);if(a?.data?.success&&a.data.data){const l=a.data.data;tl.value={CategoriesName:l.CategoriesName||e.CategoriesName,ParentCategoriesID:l.ParentCategoriesID||e.ParentCategoriesID,CategoriesPDF:l.CategoriesPDF||e.CategoriesPDF,Contact:l.Contact||""}}}catch(a){}Ha.value=!0}(nl.value),ml())}function Cl(){nl.value&&(kl(nl.value),ml())}function hl(){tl.value={CategoriesName:"",ParentCategoriesID:"",CategoriesPDF:"",Contact:""},el.value=!1,al.value=null}function yl(){Ha.value=!1,hl()}const wl=async()=>{if(tl.value.CategoriesName?.trim()){ll.value=!0;try{const e={categoriesName:tl.value.CategoriesName.trim(),parentCategoriesID:tl.value.ParentCategoriesID||null,categoriesPDF:tl.value.CategoriesPDF?.trim()||null,contact:tl.value.Contact?.trim()||null};el.value&&al.value?(await Fa.put(`/categories/crud/update/${al.value}`,e),La?.fire({icon:"success",title:"Saved",text:"แก้ไขหมวดหมู่สำเร็จ",toast:!0,position:"bottom-end",timer:2e3,showConfirmButton:!1})):(await Fa.post("/categories/crud/create",e),La?.fire({icon:"success",title:"Created",text:"เพิ่มหมวดหมู่สำเร็จ",toast:!0,position:"bottom-end",timer:2e3,showConfirmButton:!1})),yl(),await Fl()}catch(e){La?.fire({icon:"error",title:"Error",text:e.response?.data?.message||"Operation failed",toast:!0,position:"bottom-end",timer:4e3,showConfirmButton:!1})}finally{ll.value=!1}}else La?.fire({icon:"warning",title:"Required",text:"กรุณากรอกชื่อหมวดหมู่",toast:!0,position:"bottom-end",timer:3e3,showConfirmButton:!1})},kl=async e=>{try{await ja({title:"ยืนยันการลบ",message:`ต้องการลบหมวดหมู่ "<strong>${e.CategoriesName}</strong>" ใช่หรือไม่?`,variant:"danger",confirmText:"ลบ",loadingText:"กำลังลบ...",onConfirm:async()=>{const a=await Fa.delete(`/categories/crud/delete/${e.CategoriesID}`);a?.data&&a.data.data&&a.data.data.alreadyRemoved?(await Fl(),La?.fire({icon:"info",title:"Removed",text:"หมวดหมู่นี้ถูกลบไปแล้ว",toast:!0,position:"bottom-end",timer:2e3,showConfirmButton:!1})):(La?.fire({icon:"success",title:"Deleted",text:"ลบหมวดหมู่เรียบร้อย",toast:!0,position:"bottom-end",timer:2e3,showConfirmButton:!1}),await Fl())}})}catch(a){400===a.response?.status&&a.response?.data?.qaCount?La?.fire({icon:"error",title:"Failed",text:a.response?.data?.message||"Delete failed"}):404===a.response?.status?(await Fl(),La?.fire({icon:"info",title:"Not Found",text:"ไม่พบหมวดหมู่ที่ต้องการลบ (อาจถูกลบไปแล้ว)"})):a.response&&La?.fire({icon:"error",title:"Failed",text:a.response?.data?.message||"Delete failed"})}};function xl(e){const a=e.target.files?.[0];a&&(a.name.toLowerCase().endsWith(".csv")?(Qa.value=a,e.target.value=""):La?.fire({icon:"error",title:"Invalid File",text:"Please upload a CSV file"}))}function Dl(e){const a=e.dataTransfer?.files?.[0];a&&a.name.toLowerCase().endsWith(".csv")&&(Qa.value=a)}const Il=async()=>{if(Qa.value){Xa.value=!0;try{const e=new FormData;e.append("file",Qa.value),await Fa.post("/categories/upload",e,{headers:{"Content-Type":"multipart/form-data"}}),La?.fire({icon:"success",title:"Uploaded!",toast:!0,position:"bottom-end",timer:3e3,showConfirmButton:!1}),await Fl(),dl()}catch(e){La?.fire({icon:"error",title:"Upload Failed",text:e.response?.data?.message||e.message,toast:!0,position:"bottom-end",timer:4e3,showConfirmButton:!1})}finally{Xa.value=!1}}},Pl=async()=>{if(!Za.value){Za.value=!0;try{Nl((await Fa.get("/categories/crud/template",{responseType:"blob"})).data,"categories_template.csv")}catch(e){}finally{Za.value=!1}}},Sl=async()=>{if(!Ya.value){Ya.value=!0;try{Nl((await Fa.get("/categories/last-upload",{responseType:"blob"})).data,"last_uploaded.csv")}catch(e){La?.fire({icon:"info",title:"No File",text:"No previously uploaded file found"})}finally{Ya.value=!1}}};function Nl(e,a){const l=window.URL.createObjectURL(new Blob([e])),t=document.createElement("a");t.href=l,t.setAttribute("download",a),document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(l)}const Fl=async()=>{za.value=!0;try{const e=await Fa.get("/getcategories");Ea.value=e.data?.categories||[]}catch(e){Aa.value="Failed to load"}finally{za.value=!1}},Ll=l(1),jl=l(5);function Bl(e){if(!e)return!1;const a=String(e.CategoriesID??"").trim(),l=String(e.ParentCategoriesID??"").trim();if(!l||l===a)return!0;return!(Ea.value||[]).some(e=>String(e.CategoriesID)===l)}function Tl(e){const a=String(e).toLowerCase();return a.endsWith(".pdf")?"bi bi-file-earmark-pdf-fill text-danger":a.endsWith(".doc")||a.endsWith(".docx")?"bi bi-file-earmark-word-fill text-primary":"bi bi-file-earmark-text-fill text-secondary"}function Ml(e){return e?String(e).split(/ \|\|\| |\n/).map(e=>e.trim()).filter(Boolean):[]}function Vl(e){if(!e)return"-";const a=(Ea.value||[]).find(a=>String(a.CategoriesID)===String(e));return a?.CategoriesName||"-"}function Ul(e){return e?(Ea.value||[]).filter(a=>String(a.ParentCategoriesID)===String(e)&&String(a.CategoriesID)!==String(e)).length:0}const _l=t(()=>Oa.value),Ol=t(()=>{const e=(Ea.value||[]).filter((e,a,l)=>l.findIndex(a=>a.CategoriesID===e.CategoriesID)===a);if(!_a.value)return e;const a=_a.value.toLowerCase();return e.filter(e=>String(e.CategoriesID).toLowerCase().includes(a)||String(e.CategoriesName).toLowerCase().includes(a))}),Rl=t(()=>{let e=Ol.value.filter(e=>Bl(e));"main"===Ra.value.status?e=e.filter(e=>Bl(e)):"sub"===Ra.value.status&&(e=Ol.value.filter(e=>!Bl(e)));const a=Ra.value.sortBy,l=Ra.value.sortOrder;e.sort((e,t)=>{let s,i;if("id"===a){const a=String(e.CategoriesID||""),s=String(t.CategoriesID||""),i=a.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return"asc"===l?i:-i}if("name"===a?(s=(e.CategoriesName||"").toLowerCase(),i=(t.CategoriesName||"").toLowerCase()):(s=e.CategoriesID,i=t.CategoriesID),"id"!==a){if(s<i)return"asc"===l?-1:1;if(s>i)return"asc"===l?1:-1}return 0});const t=(Ll.value-1)*jl.value,s=t+jl.value;return e.slice(t,s)});function Wl(e,a){return(Ea.value||[]).filter(l=>String(l.ParentCategoriesID)===String(e)&&String(l.CategoriesID)!==String(a)).sort((e,a)=>{const l=String(e.CategoriesID||""),t=String(a.CategoriesID||"");return l.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})})}const $l=t(()=>"sub"===Ra.value.status?Ol.value.filter(e=>!Bl(e)).length:Ol.value.filter(e=>Bl(e)).length),ql=t(()=>Math.ceil($l.value/jl.value)||1),El=t(()=>Ll.value),zl=t(()=>(Ll.value-1)*jl.value+1),Al=t(()=>Math.min(Ll.value*jl.value,$l.value)),Gl=t(()=>{const e=ql.value,a=El.value;return e<=5?Array.from({length:e},(e,a)=>a+1):a<=3?[1,2,3,4,5]:a>=e-2?[e-4,e-3,e-2,e-1,e]:[a-2,a-1,a,a+1,a+2]});function Hl(e){e>=1&&e<=ql.value&&(Ll.value=e)}function Jl(){Hl(El.value-1)}function Kl(){Hl(El.value+1)}function Ql(){Hl(1)}function Xl(){Hl(ql.value)}s(_a,()=>Ll.value=1),i(()=>{Va=N();if(!localStorage.getItem("userToken"))return void Sa.replace({name:"login"});const e=localStorage.getItem("userInfo");e&&(Ta.value=JSON.parse(e)),Ma.value=localStorage.getItem("userType")||"",Fl(),o(()=>{document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(e=>new F(e))})});const Yl=()=>{const e=document.querySelector(".sidebar");!j.value?(Ua=T.value,T.value=!1,e&&e.classList.remove("collapsed"),document.body.classList.add("sidebar-open"),document.body.classList.add("sidebar-mobile-expanded"),j.value=!0):(T.value=!!Ua,e&&Ua&&e.classList.add("collapsed"),document.body.classList.remove("sidebar-open"),document.body.classList.remove("sidebar-mobile-expanded"),j.value=!1,Ua=null)};return n(()=>{Va&&Va()}),(e,a)=>(c(),r("div",M,[d(L,{userType:Ma.value,userInfoObject:Ta.value},null,8,["userType","userInfoObject"]),u("main",V,[u("div",U,[za.value?(c(),r("div",_,[...a[11]||(a[11]=[u("div",{class:"spinner-border text-primary",role:"status"},[u("span",{class:"visually-hidden"},"Loading...")],-1),u("p",{class:"mt-2"},"Loading categories data...",-1)])])):(c(),r("div",O,[v(j)?(c(),r("div",{key:0,class:"mobile-sidebar-backdrop",onClick:Yl,"aria-hidden":"true"})):p("",!0),u("div",R,[u("div",W,[u("button",{class:"mobile-sidebar-toggle mobile-inline-toggle",onClick:f(Yl,["stop"]),"aria-label":v(j)?"Close sidebar":"Open sidebar"},[u("i",{class:m(v(j)?"bi bi-x":"bi bi-list")},null,2)],8,$),a[14]||(a[14]=g('<svg class="brain-icon" width="40" height="40" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-87f45801><circle cx="32" cy="32" r="30" fill="#059669" opacity="0.08" data-v-87f45801></circle><rect class="brain-outline brain-left" x="14" y="14" width="16" height="16" stroke="#059669" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none" data-v-87f45801></rect><rect class="brain-wrinkle wrinkle-1" x="34" y="14" width="16" height="16" stroke="#059669" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none" data-v-87f45801></rect><rect class="brain-wrinkle wrinkle-2" x="14" y="34" width="16" height="16" stroke="#059669" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none" data-v-87f45801></rect><rect class="brain-wrinkle wrinkle-1" x="34" y="34" width="16" height="16" stroke="#059669" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="none" data-v-87f45801></rect><g class="neuron-group" data-v-87f45801><circle class="neuron-glow" cx="22" cy="22" r="5" fill="#059669" opacity="0.2" data-v-87f45801></circle><circle class="neuron neuron-1" cx="22" cy="22" r="2.5" fill="#059669" data-v-87f45801></circle></g><g class="neuron-group" data-v-87f45801><circle class="neuron-glow" cx="42" cy="42" r="5" fill="#10b981" opacity="0.2" data-v-87f45801></circle><circle class="neuron neuron-2" cx="42" cy="42" r="2.5" fill="#10b981" data-v-87f45801></circle></g></svg><h2 class="page-title m-0" data-v-87f45801>Manage Categories</h2>',2)),u("div",q,[u("button",{class:"apple-btn-primary",onClick:a[0]||(a[0]=e=>(hl(),void(Ha.value=!0)))},[...a[12]||(a[12]=[u("i",{class:"bi bi-plus-lg"},null,-1),u("span",{class:"d-none d-sm-inline"},"เพิ่มหมวดหมู่",-1)])]),u("button",{class:"apple-icon-btn-large",onClick:cl,title:"อัพโหลด CSV"},[...a[13]||(a[13]=[u("i",{class:"bi bi-cloud-upload"},null,-1)])])])]),a[17]||(a[17]=g('<div class="info-card apple-card mb-4 p-4 rounded-4 shadow-apple" data-v-87f45801><svg class="book-icon float-start me-3" width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-87f45801><circle cx="36" cy="36" r="32" fill="#059669" opacity="0.08" data-v-87f45801></circle><rect x="14" y="14" width="18" height="18" stroke="#059669" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none" data-v-87f45801></rect><rect x="40" y="14" width="18" height="18" stroke="#059669" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none" data-v-87f45801></rect><rect x="14" y="40" width="18" height="18" stroke="#059669" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none" data-v-87f45801></rect><rect x="40" y="40" width="18" height="18" stroke="#059669" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none" data-v-87f45801></rect><circle class="neuron" cx="23" cy="23" r="2.5" fill="#059669" opacity="0" data-v-87f45801></circle><circle class="neuron" cx="49" cy="49" r="2.5" fill="#10b981" opacity="0" data-v-87f45801></circle></svg><h5 class="fw-bold mb-3" data-v-87f45801>หมวดหมู่คืออะไร?</h5><p class="mb-2 text-muted" data-v-87f45801><strong data-v-87f45801>หมวดหมู่</strong> คือการจัดหมวดหมู่คำถาม-คำตอบให้เป็นระเบียบ เพื่อให้ระบบสามารถค้นหาและจัดการข้อมูลได้อย่างมีประสิทธิภาพ</p><ul class="mb-3 text-muted small" data-v-87f45801><li class="d-flex align-items-center gap-2 mb-2" data-v-87f45801><svg class="icon-svg" width="20" height="20" viewBox="0 0 20 20" fill="none" data-v-87f45801><rect x="2" y="2" width="8" height="8" stroke="#059669" stroke-width="2" data-v-87f45801></rect><rect x="12" y="2" width="6" height="8" stroke="#059669" stroke-width="2" data-v-87f45801></rect><rect x="2" y="12" width="8" height="6" stroke="#059669" stroke-width="2" data-v-87f45801></rect><rect x="12" y="12" width="6" height="6" stroke="#059669" stroke-width="2" data-v-87f45801></rect></svg><span data-v-87f45801>องค์กายสามารถสร้างหมวดหมู่ตามกระทำการบริการที่ต้องการ</span></li><li class="d-flex align-items-center gap-2 mb-2" data-v-87f45801><svg class="icon-svg" width="20" height="20" viewBox="0 0 20 20" fill="none" data-v-87f45801><circle cx="10" cy="10" r="8" stroke="#059669" stroke-width="2" data-v-87f45801></circle><path d="M6 10 L9 13 L14 7" stroke="#059669" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-87f45801></path></svg><span data-v-87f45801>ทำให้การค้นหาและการจัดการข้อมูลเป็นระเบียบและง่ายขึ้น</span></li><li class="d-flex align-items-center gap-2" data-v-87f45801><svg class="icon-svg" width="20" height="20" viewBox="0 0 20 20" fill="none" data-v-87f45801><path d="M4 5 L16 5 M4 10 L16 10 M4 15 L16 15" stroke="#059669" stroke-width="2" stroke-linecap="round" data-v-87f45801></path></svg><span data-v-87f45801>สามารถอัพโหลด CSV เพื่อเพิ่มหมวดหมู่จำนวนมากได้ทีเดียว</span></li></ul><p class="mb-0 small text-success fw-bold d-flex align-items-center gap-2" data-v-87f45801><svg class="icon-svg" width="20" height="20" viewBox="0 0 20 20" fill="none" data-v-87f45801><circle cx="10" cy="10" r="8" stroke="#059669" stroke-width="2" data-v-87f45801></circle><path d="M10 6 L10 11" stroke="#ffd60a" stroke-width="2" stroke-linecap="round" data-v-87f45801></path><path d="M8 14 L12 14" stroke="#059669" stroke-width="2" stroke-linecap="round" data-v-87f45801></path><circle cx="10" cy="8" r="4" fill="#ffd60a" opacity="0.3" data-v-87f45801></circle></svg><span data-v-87f45801>สามารถเพิ่ม/ลบ/แก้ไข หมวดหมู่ได้ตลอดเวลา</span></p></div>',1)),u("div",E,[u("div",z,[a[16]||(a[16]=u("i",{class:"bi bi-search search-icon"},null,-1)),b(u("input",{type:"text",class:"search-input",placeholder:"ค้นหาหมวดหมู่...","onUpdate:modelValue":a[1]||(a[1]=e=>_a.value=e)},null,512),[[C,_a.value]]),_a.value?(c(),r("button",{key:0,class:"search-clear",onClick:a[2]||(a[2]=e=>_a.value="")},[...a[15]||(a[15]=[u("i",{class:"bi bi-x-circle-fill"},null,-1)])])):p("",!0)])])]),d(B,{modelValue:Ra.value,"onUpdate:modelValue":a[3]||(a[3]=e=>Ra.value=e),"sort-options":Wa,statuses:$a,"status-label":"ประเภท","show-date-range":!1,"show-date-presets":!1,"show-number-range":!1,class:"px-3 mb-3",onChange:qa},null,8,["modelValue"]),u("div",A,[u("div",G,[u("table",H,[a[24]||(a[24]=u("thead",null,[u("tr",null,[u("th",{class:"ps-4",style:{width:"50px"}}),u("th",null,"CategoriesID"),u("th",null,"CategoriesName"),u("th",null,"Type"),u("th",null,"Contact"),u("th",null,"File")])],-1)),u("tbody",null,[(c(!0),r(h,null,y(Rl.value,(e,l)=>{return c(),r(h,{key:e.CategoriesID},[u("tr",{class:"align-middle parent-row clickable-row",onClick:a=>fl(e)},[u("td",K,[(t=e.CategoriesID,s=e.CategoriesID,Wl(t,s).length>0?(c(),r("button",{key:0,class:"expand-btn",onClick:f(a=>function(e){const a=Oa.value[e];Oa.value={},a||(Oa.value[e]=!0)}(e.CategoriesID),["stop"])},[u("i",{class:m(["bi",_l.value[e.CategoriesID]?"bi-chevron-up":"bi-chevron-down"])},null,2)],8,Q)):p("",!0))]),u("td",X,w(e.CategoriesID),1),u("td",Y,w(e.CategoriesName),1),u("td",Z,[u("span",{class:m(Bl(e)?"apple-badge-blue":"apple-badge-gray")},w(Bl(e)?"Main":"Sub"),3)]),u("td",ee,[e.Contact?(c(),r("div",ae,[(c(!0),r(h,null,y(Ml(e.Contact),(e,a)=>(c(),r("div",{key:a,class:"small text-secondary text-truncate",style:{"max-width":"200px"}},w(e),1))),128))])):(c(),r("span",le,"-"))]),u("td",te,[e.CategoriesPDF?(c(),r("button",{key:0,onClick:f(a=>vl(e.CategoriesPDF,e.CategoriesName),["stop","prevent"]),class:"file-link-btn"},[u("i",{class:m(Tl(e.CategoriesPDF))},null,2),a[18]||(a[18]=u("span",null,"View",-1))],8,se)):(c(),r("span",ie,"-"))])],8,J),(c(!0),r(h,null,y(_l.value[e.CategoriesID]?Wl(e.CategoriesID,e.CategoriesID):[],e=>(c(),r("tr",{key:e.CategoriesID,class:"sub-row clickable-row",onClick:a=>fl(e)},[a[21]||(a[21]=u("td",{"data-label":""},null,-1)),u("td",ne,[a[19]||(a[19]=u("span",{class:"tree-line"},"└",-1)),x(" "+w(e.CategoriesID),1)]),u("td",re,w(e.CategoriesName),1),a[22]||(a[22]=u("td",{"data-label":"Type"},[u("span",{class:"apple-badge-gray"},"Sub")],-1)),u("td",ce,[e.Contact?(c(),r("div",de,[(c(!0),r(h,null,y(Ml(e.Contact),(e,a)=>(c(),r("div",{key:a,class:"small text-secondary text-truncate"},w(e),1))),128))])):(c(),r("span",ue,"-"))]),u("td",pe,[e.CategoriesPDF?(c(),r("button",{key:0,onClick:f(a=>vl(e.CategoriesPDF,e.CategoriesName),["stop","prevent"]),class:"file-link-btn"},[u("i",{class:m(Tl(e.CategoriesPDF))},null,2),a[20]||(a[20]=u("span",null,"View",-1))],8,ve)):(c(),r("span",ge,"-"))])],8,oe))),128))],64);var t,s}),128)),0===Rl.value.length?(c(),r("tr",fe,[...a[23]||(a[23]=[u("td",{colspan:"6",class:"text-center text-muted py-5"},[u("div",{class:"empty-state"},[u("i",{class:"bi bi-folder-x"}),u("p",null,"No categories found")])],-1)])])):p("",!0)])])]),u("div",me,[u("div",be," Showing "+w(zl.value)+" to "+w(Al.value)+" of "+w($l.value)+" entries ",1),u("nav",Ce,[u("ul",he,[u("li",{class:m(["page-item",{disabled:1===El.value}])},[u("a",{class:"page-link",href:"#",onClick:f(Ql,["prevent"])},"«")],2),u("li",{class:m(["page-item",{disabled:1===El.value}])},[u("a",{class:"page-link",href:"#",onClick:f(Jl,["prevent"])},"‹")],2),(c(!0),r(h,null,y(Gl.value,e=>(c(),r("li",{key:e,class:m(["page-item",{active:El.value===e}])},[u("a",{class:"page-link",href:"#",onClick:f(a=>Hl(e),["prevent"])},w(e),9,ye)],2))),128)),u("li",{class:m(["page-item",{disabled:El.value===ql.value}])},[u("a",{class:"page-link",href:"#",onClick:f(Kl,["prevent"])},"›")],2),u("li",{class:m(["page-item",{disabled:El.value===ql.value}])},[u("a",{class:"page-link",href:"#",onClick:f(Xl,["prevent"])},"»")],2)])])])])]))])]),d(I,{name:"apple-zoom"},{default:k(()=>[Ha.value?(c(),r("div",{key:0,class:"apple-modal-overlay",onClick:f(yl,["self"])},[u("div",we,[a[33]||(a[33]=u("div",{class:"apple-modal-header-bg"},null,-1)),u("div",ke,[u("div",xe,[u("h5",De,w(el.value?"แก้ไขหมวดหมู่":"เพิ่มหมวดหมู่ใหม่"),1),u("span",Ie,w(el.value?"Edit Category":"Create New Category"),1)]),u("button",{class:"apple-close-btn",onClick:yl},[...a[25]||(a[25]=[u("i",{class:"bi bi-x-lg"},null,-1)])])]),u("div",Pe,[u("form",{onSubmit:f(wl,["prevent"]),class:"apple-form-container"},[u("div",Se,[a[26]||(a[26]=u("label",null,[x("ชื่อหมวดหมู่ (Category Name) "),u("span",{class:"text-danger"},"*")],-1)),b(u("input",{type:"text",class:"apple-input","onUpdate:modelValue":a[4]||(a[4]=e=>tl.value.CategoriesName=e),required:"",placeholder:"เช่น ทุนการศึกษา"},null,512),[[C,tl.value.CategoriesName]])]),u("div",Ne,[a[29]||(a[29]=u("label",null,"ประเภทหมวดหมู่ (Parent Category)",-1)),u("div",Fe,[b(u("select",{class:"apple-input","onUpdate:modelValue":a[5]||(a[5]=e=>tl.value.ParentCategoriesID=e)},[a[27]||(a[27]=u("option",{value:""},"หมวดหมู่หลัก (Main Category)",-1)),(c(!0),r(h,null,y(rl.value,e=>(c(),r("option",{key:e.CategoriesID,value:e.CategoriesID,disabled:el.value&&al.value===e.CategoriesID},w(e.CategoriesID)+" - "+w(e.CategoriesName),9,Le))),128))],512),[[D,tl.value.ParentCategoriesID]]),a[28]||(a[28]=u("i",{class:"bi bi-chevron-down select-icon"},null,-1))])]),u("div",je,[a[31]||(a[31]=u("label",null,"ลิงก์ PDF (Optional)",-1)),u("div",Be,[a[30]||(a[30]=u("i",{class:"bi bi-link-45deg input-icon"},null,-1)),b(u("input",{type:"url",class:"apple-input ps-5","onUpdate:modelValue":a[6]||(a[6]=e=>tl.value.CategoriesPDF=e),placeholder:"https://example.com/file.pdf"},null,512),[[C,tl.value.CategoriesPDF]])])]),u("div",Te,[a[32]||(a[32]=u("label",null,"ข้อมูลติดต่อ (Contact / Notes)",-1)),b(u("textarea",{rows:"3",class:"apple-input apple-textarea","onUpdate:modelValue":a[7]||(a[7]=e=>tl.value.Contact=e),placeholder:"เบอร์โทรศัพท์, หมายเหตุ..."},null,512),[[C,tl.value.Contact]])]),u("div",Me,[u("button",{type:"button",class:"apple-btn-secondary",onClick:yl},"ยกเลิก"),u("button",{type:"submit",class:"apple-btn-primary",disabled:ll.value},[ll.value?(c(),r("span",Ue)):p("",!0),x(" "+w(el.value?"บันทึกการแก้ไข":"เพิ่มหมวดหมู่"),1)],8,Ve)])],32)])])])):p("",!0)]),_:1}),d(I,{name:"apple-zoom"},{default:k(()=>[Ga.value?(c(),r("div",{key:0,class:"apple-modal-overlay",onClick:f(dl,["self"])},[u("div",_e,[a[44]||(a[44]=u("div",{class:"apple-modal-header-bg"},null,-1)),u("div",{class:"apple-modal-header"},[a[35]||(a[35]=u("div",{class:"d-flex flex-column"},[u("h5",{class:"apple-modal-title"},"อัพโหลดไฟล์"),u("span",{class:"apple-modal-subtitle"},"Import CSV Data")],-1)),u("button",{class:"apple-close-btn",onClick:dl},[...a[34]||(a[34]=[u("i",{class:"bi bi-x-lg"},null,-1)])])]),u("div",Oe,[u("div",{class:m(["upload-drop-area-apple",{"has-file":Qa.value}]),onDrop:f(Dl,["prevent"]),onDragover:a[8]||(a[8]=f(()=>{},["prevent"])),onClick:a[9]||(a[9]=a=>e.$refs.fileInput.click())},[a[38]||(a[38]=u("div",{class:"upload-icon-wrapper"},[u("i",{class:"bi bi-cloud-arrow-up-fill"})],-1)),u("div",Re,[Qa.value?(c(),r("span",$e,[a[37]||(a[37]=u("i",{class:"bi bi-file-earmark-spreadsheet-fill me-2 text-success"},null,-1)),x(w(Qa.value.name),1)])):(c(),r("span",We,[...a[36]||(a[36]=[x("ลากไฟล์มาวางที่นี่ หรือ ",-1),u("strong",null,"คลิกเลือกไฟล์",-1)])]))]),a[39]||(a[39]=u("div",{class:"upload-hint"},"รองรับไฟล์ .csv เท่านั้น",-1)),u("input",{ref:"fileInput",type:"file",accept:".csv",class:"d-none",onChange:xl},null,544)],34),u("div",qe,[u("button",{class:"apple-btn-secondary small",onClick:f(Pl,["stop"]),disabled:Za.value},[...a[40]||(a[40]=[u("i",{class:"bi bi-file-earmark-arrow-down me-1"},null,-1),x(" Template ",-1)])],8,Ee),u("button",{class:"apple-btn-secondary small",onClick:f(ul,["stop"])},[...a[41]||(a[41]=[u("i",{class:"bi bi-eye me-1"},null,-1),x(" ตัวอย่าง ",-1)])]),u("button",{class:"apple-btn-secondary small",onClick:f(Sl,["stop"]),disabled:Ya.value},[...a[42]||(a[42]=[u("i",{class:"bi bi-clock-history me-1"},null,-1),x(" ไฟล์ล่าสุด ",-1)])],8,ze)]),u("div",Ae,[u("button",{class:"apple-btn-secondary",onClick:dl,disabled:Xa.value},"ยกเลิก",8,Ge),u("button",{class:"apple-btn-primary",onClick:Il,disabled:!Qa.value||Xa.value},[Xa.value?(c(),r("span",Je)):p("",!0),a[43]||(a[43]=x(" อัพโหลด ",-1))],8,He)])])])])):p("",!0)]),_:1}),d(I,{name:"apple-zoom"},{default:k(()=>[Ja.value?(c(),r("div",{key:0,class:"apple-modal-overlay",onClick:f(pl,["self"])},[u("div",Ke,[u("div",{class:"apple-modal-header"},[a[46]||(a[46]=u("h5",{class:"apple-modal-title"},"Template Example",-1)),u("button",{class:"apple-close-btn",onClick:pl},[...a[45]||(a[45]=[u("i",{class:"bi bi-x-lg"},null,-1)])])]),u("div",Qe,[u("img",{src:v("/~s651102064101/frontend/assets/svg/ex4-Bp0WwvEW.svg"),alt:"Template Example",class:"img-fluid",style:{"max-height":"70vh"}},null,8,Xe)])])])):p("",!0)]),_:1}),d(I,{name:"apple-zoom"},{default:k(()=>{return[Ka.value?(c(),r("div",{key:0,class:"apple-modal-overlay",onClick:f(gl,["self"])},[u("div",Ye,[u("div",Ze,[u("div",ea,[a[47]||(a[47]=u("i",{class:"bi bi-file-earmark-pdf text-danger fs-5"},null,-1)),u("span",aa,w(il.value),1)]),u("div",la,[u("a",{href:sl.value,target:"_blank",class:"apple-icon-btn"},[...a[48]||(a[48]=[u("i",{class:"bi bi-box-arrow-up-right"},null,-1)])],8,ta),u("button",{class:"apple-close-btn",onClick:gl},[...a[49]||(a[49]=[u("i",{class:"bi bi-x-lg"},null,-1)])])])]),u("div",sa,[(e=sl.value,String(e).toLowerCase().trim().endsWith(".pdf")?(c(),r("iframe",{key:0,src:sl.value,frameborder:"0",class:"w-100 h-100"},null,8,ia)):(c(),r("div",oa,[a[50]||(a[50]=u("i",{class:"bi bi-file-earmark-x fs-1 text-muted mb-3"},null,-1)),a[51]||(a[51]=u("p",null,"Preview not available",-1)),u("a",{href:sl.value,target:"_blank",class:"apple-btn-primary"},"Download File",8,na)])))])])])):p("",!0)];var e}),_:1}),ol.value?(c(),r("div",{key:0,class:"drawer-overlay",onClick:ml})):p("",!0),u("div",{class:m(["apple-drawer",{"drawer-open":ol.value}])},[u("div",{class:"drawer-header"},[a[53]||(a[53]=u("h5",{class:"drawer-title"},"รายละเอียดหมวดหมู่",-1)),u("button",{class:"btn-close-drawer",onClick:ml},[...a[52]||(a[52]=[u("i",{class:"bi bi-x-lg"},null,-1)])])]),u("div",ra,[u("div",ca,[a[54]||(a[54]=u("div",{class:"drawer-label"},"CategoriesID",-1)),u("div",da,w(nl.value?.CategoriesID||"-"),1)]),u("div",ua,[a[55]||(a[55]=u("div",{class:"drawer-label"},"ชื่อหมวดหมู่",-1)),u("div",pa,w(nl.value?.CategoriesName||"-"),1)]),u("div",va,[a[56]||(a[56]=u("div",{class:"drawer-label"},"ประเภท",-1)),u("div",ga,[u("span",{class:m(Bl(nl.value)?"apple-badge-blue":"apple-badge-gray")},w(Bl(nl.value)?"Main Category":"Sub Category"),3)])]),nl.value?.ParentCategoriesID&&!Bl(nl.value)?(c(),r("div",fa,[a[57]||(a[57]=u("div",{class:"drawer-label"},"หมวดหมู่หลัก (Parent)",-1)),u("div",ma,[u("span",ba,w(Vl(nl.value?.ParentCategoriesID)),1)])])):p("",!0),u("div",Ca,[a[59]||(a[59]=u("div",{class:"drawer-label"},"ข้อมูลติดต่อ",-1)),nl.value?.Contact?(c(),r("div",ha,[(c(!0),r(h,null,y(Ml(nl.value.Contact),(e,l)=>(c(),r("div",{key:l,class:"contact-item mb-1"},[a[58]||(a[58]=u("i",{class:"bi bi-telephone-fill text-success me-2"},null,-1)),x(w(e),1)]))),128))])):(c(),r("div",ya,"—"))]),u("div",wa,[a[61]||(a[61]=u("div",{class:"drawer-label"},"ไฟล์แนบ",-1)),nl.value?.CategoriesPDF?(c(),r("div",ka,[u("button",{onClick:a[10]||(a[10]=e=>vl(nl.value.CategoriesPDF,nl.value.CategoriesName)),class:"file-link-btn-large"},[u("i",{class:m(Tl(nl.value.CategoriesPDF))},null,2),a[60]||(a[60]=u("span",null,"ดูไฟล์",-1))])])):(c(),r("div",xa,"—"))]),Ul(nl.value?.CategoriesID)>0?(c(),r("div",Da,[a[62]||(a[62]=u("div",{class:"drawer-label"},"หมวดหมู่ย่อย",-1)),u("div",Ia,[u("span",Pa,w(Ul(nl.value?.CategoriesID))+" รายการ",1)])])):p("",!0)]),u("div",{class:"drawer-footer"},[u("div",{class:"d-flex gap-2"},[u("button",{class:"apple-btn-primary flex-fill",onClick:bl},[...a[63]||(a[63]=[u("i",{class:"bi bi-pencil-square me-2"},null,-1),x(" แก้ไข ",-1)])]),u("button",{class:"apple-btn-secondary text-danger flex-fill",onClick:Cl},[...a[64]||(a[64]=[u("i",{class:"bi bi-trash me-2"},null,-1),x(" ลบ ",-1)])])])])],2),d(v(Ba))]))}},[["__scopeId","data-v-87f45801"]]);export{Sa as default};
