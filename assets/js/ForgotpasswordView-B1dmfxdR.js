import{I as e,r as t,f as a,C as s,c as o,o as r,d as l,i,a as n,w as d,s as c,G as u,t as m,p,z as v}from"./vue-vendor-CaqZERVf.js";import{_ as f}from"./index-CjxO0-0y.js";import"./axios-vendor-Dos3PyFQ.js";const b={class:""},g={class:"mb-3 position-relative pt-2 pe-xl-5"},w={class:"invalid-feedback"},h={class:"mb-5 col-12 col-lg-auto mx-auto mx-lg-0 d-flex justify-content-center justify-content-lg-start"},y=["disabled"],x={key:0,class:"spinner-border spinner-border-sm me-2","aria-hidden":"true"},k={role:"status"},I=f({__name:"ForgotpasswordView",setup(f){const{appContext:I}=e(),{$axios:P,$swal:_}=I.config.globalProperties,E=t(""),j=t(""),F=t(null),S=a(),A=t(!1),B=t("Please enter a valid email");async function C(){const e=j.value;if(!1===e.checkValidity())return F.value.validity.valueMissing?B.value="Please enter an email to proceed":F.value.validity.typeMismatch&&(B.value="Please check the email format (must contain @ and a domain name)"),void e.classList.add("was-validated");e.classList.remove("was-validated"),A.value=!0;try{const e={email:E.value},t=await P.post("/forgotpassword",e,{timeout:1e4}),{success:a,maskedEmail:s}=t.data;a&&s?(_.fire({toast:!0,icon:"success",title:"A new reset link has been sent!",position:"bottom-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}),localStorage.setItem("resetFlowActive","true"),localStorage.setItem("resetEmail",E.value),localStorage.setItem("resendTimestamp",Date.now().toString()),S.push({path:"/checkemail"})):_.fire({icon:"error",title:"Request Failed",text:t.data.message||"An error occurred while processing the request.",position:"bottom-end",timerProgressBar:!0})}catch(t){t.response,t.response,_.fire({icon:"error",title:"API Error",text:(t.response?.data?.message||"Could not connect to the server.")+(t.response?.data?.error?" ("+t.response.data.error+")":""),position:"bottom-end",timerProgressBar:!0})}finally{A.value=!1}}return(e,t)=>{const a=s("router-link");return r(),o("form",{ref_key:"loginForm",ref:j,onSubmit:v(C,["prevent"]),class:"needs-validation",novalidate:""},[l("div",b,[t[5]||(t[5]=l("header",{class:"fs-1 fw-bold mb-4 text-center text-lg-start"}," Forgot password ",-1)),l("p",null,[t[3]||(t[3]=i("Remember your password? ",-1)),n(a,{to:"/login",class:"text-dark fw-bold"},{default:d(()=>[...t[2]||(t[2]=[i("Login here",-1)])]),_:1})]),l("div",g,[c(l("input",{ref_key:"emailInput",ref:F,type:"email",class:"form-control border-dark border-2 rounded-3 pt-3",id:"floatingInput",placeholder:"","onUpdate:modelValue":t[0]||(t[0]=e=>E.value=e),required:"",onInput:t[1]||(t[1]=e=>F.value.classList.remove("is-invalid"))},null,544),[[u,E.value]]),t[4]||(t[4]=l("label",{class:"fw-bold position-absolute top-0 ms-2 bg-light rounded-3 px-2 mb-0",for:"floatingInput"},"Email",-1)),l("div",w,m(B.value),1)]),l("div",h,[l("button",{type:"submit",class:"btn rounded-3 fw-bold px-4 py-3 mt-4 fs-5",style:{"background-color":"#E3E3E3"},disabled:A.value},[A.value?(r(),o("span",x)):p("",!0),l("span",k,m(A.value?"Processing...":"Reset Password"),1)],8,y)])])],544)}}},[["__scopeId","data-v-2bc96876"]]);export{I as default};
