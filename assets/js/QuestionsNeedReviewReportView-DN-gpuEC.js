import{I as e,r as a,l as t,e as l,g as s,H as i,c as n,o as r,d as o,a as u,h as c,n as d,t as v,i as p,p as g,s as b,G as m,F as w,b as y,u as f,y as h,z as D,w as C,K as k,D as x,q as I,L as S,f as T}from"./vue-vendor-CaqZERVf.js";import{_ as R,A,f as O,T as Q,b as N,i as q,S as M,c as _,a as j}from"./index-YNQFrYK5.js";import{c as F,W as L}from"./dashboard-styles-DF6dX7li.js";import"./auto-oB3XP6c3.js";/* empty css                                                                     */import{C as E,r as U}from"./chart-CicJT4lR.js";import"./axios-vendor-Dos3PyFQ.js";const V={class:"dashboard-container"},P={class:"container-fluid pt-2 px-4 pb-5"},B={class:"d-flex align-items-center justify-content-between mb-4 fade-in-up"},W={class:"d-flex align-items-center gap-2"},H={key:0,class:"text-center py-5 fade-in"},K={key:1,class:"alert apple-alert-danger mx-auto",role:"alert"},z={key:2,class:"fade-in-up",style:{"animation-delay":"0.1s"}},$={class:"row mb-4 g-3"},G={class:"col-md-4"},J={class:"apple-stat-card"},Z={class:"stat-content"},X={class:"stat-value"},Y={class:"col-md-4"},ee={class:"apple-stat-card"},ae={class:"stat-content"},te={class:"stat-value"},le={class:"col-md-4"},se={class:"apple-stat-card"},ie={class:"stat-content"},ne={class:"stat-value"},re={class:"row mb-4 g-4"},oe={key:0,class:"col-12 col-lg-6"},ue={class:"apple-card chart-card h-100"},ce={class:"chart-area"},de={key:1,class:"col-12 col-lg-6"},ve={class:"apple-card chart-card h-100"},pe={class:"chart-area"},ge={class:"apple-card table-wrapper"},be={class:"card-header-actions p-3 d-flex justify-content-between align-items-center"},me={class:"apple-counter-capsule"},we={class:"count"},ye={class:"search-container"},fe={class:"table-responsive"},he={class:"table apple-table mb-0"},De=["onClick"],Ce={class:"ps-4 fw-medium text-secondary","data-label":"ID"},ke={class:"py-3","data-label":"Question Title"},xe=["title"],Ie={class:"py-3","data-label":"Review Date"},Se=["title"],Te={class:"py-3","data-label":"Category"},Re={class:"py-3","data-label":"Status"},Ae={key:0},Oe={class:"d-flex justify-content-between align-items-center p-3 border-top bg-white rounded-bottom-4"},Qe={class:"small text-secondary"},Ne={"aria-label":"Page navigation"},qe={class:"pagination pagination-sm mb-0 align-items-center"},Me=["onClick"],_e={class:"apple-modal-content wide-modal"},je={class:"apple-modal-body"},Fe={key:0,class:"text-center py-5"},Le={key:1,class:"apple-form-container"},Ee={class:"apple-input-group"},Ue={class:"apple-input-group"},Ve={class:"row g-3"},Pe={class:"col-md-6"},Be={class:"apple-input-group"},We={class:"col-md-6"},He={class:"apple-input-group"},Ke={class:"select-wrapper"},ze=["value","disabled"],$e={class:"apple-input-group"},Ge={class:"keyword-input-wrapper"},Je=["onKeyup"],Ze={class:"d-flex flex-wrap gap-2 mt-2"},Xe=["onClick"],Ye={class:"apple-actions"},ea=["disabled"],aa=["disabled"],ta={key:0,class:"spinner-border spinner-border-sm me-2"},la=R({__name:"QuestionsNeedReviewReport",props:{categoriesNameMap:{type:Object,default:()=>({})},formatThaiDateTime:Function,daysThreshold:{type:Number,default:30}},setup(T){const R=T,{appContext:N}=e(),q=N.config.globalProperties.$axios,M=a([]),_=a(!0),j=a(null),U=a(!1),la=a(!1),sa=a(!1),ia=a([]),na=t(()=>{const e=ia.value||[],a=Array.isArray(e)?e.filter(e=>e&&null!=e.CategoriesID):[],t=a.filter(e=>!String(e.CategoriesID).includes("-")).sort((e,a)=>String(e.CategoriesID).localeCompare(String(a.CategoriesID),void 0,{numeric:!0})),l=[];for(const s of t){l.push({...s,isMain:!0});const e=String(s.CategoriesID),t=a.filter(a=>{const t=String(a.CategoriesID);return t!==e&&t.startsWith(e+"-")}).sort((e,a)=>String(e.CategoriesID).localeCompare(String(a.CategoriesID),void 0,{numeric:!0}));for(const a of t)l.push({...a,isMain:!1})}return l}),ra=a(""),oa=a({questionTitle:"",questionText:"",reviewDate:"",categoriesId:"",keywords:[]}),ua=a(null),ca=a(null),da=a(null);let va=null,pa=null;const ga=a(!1);let ba=null;const ma=a(""),wa=a(1),ya=a(5),fa=a({sortBy:"date",sortOrder:"asc",category:"",status:"",datePreset:"all",dateFrom:"",dateTo:""}),ha=[{value:"date",label:"วันหมดอายุ"},{value:"id",label:"รหัส"},{value:"title",label:"หัวข้อ"}],Da=[{value:"overdue",label:"Overdue",icon:"bi bi-exclamation-circle-fill",color:"danger"},{value:"urgent",label:"Urgent",icon:"bi bi-exclamation-triangle-fill",color:"warning"},{value:"soon",label:"Review Soon",icon:"bi bi-clock-fill",color:"info"}],Ca=t(()=>{const e=R.categoriesNameMap||{};return Object.entries(e).map(([e,a])=>({value:e,label:a||e}))});function ka(){wa.value=1}l(ma,()=>{wa.value=1}),l(fa,()=>{wa.value=1},{deep:!0});const xa=t(()=>R.categoriesNameMap||{}),Ia=["#0071e3","#34C759","#FF9500","#FF3B30","#5856D6","#AF52DE","#5AC8FA","#FF2D55"];function Sa(e){if(!e)return"-";const a=new Date(e);return isNaN(a.getTime())?e:a.toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"})}const Ta=e=>{if(!e.ReviewDate)return"No Date";const a=new Date(e.ReviewDate)-new Date,t=Math.ceil(a/864e5);return t<0?"Overdue":t<=7?"Urgent":t<=30?"Review Soon":"On Schedule"},Ra=e=>{if(!e.ReviewDate)return"status-pill gray";const a=new Date(e.ReviewDate)-new Date,t=Math.ceil(a/864e5);return t<0?"status-pill red":t<=7?"status-pill orange":t<=30?"status-pill yellow":"status-pill green"},Aa=e=>{if(!e)return"apple-badge-gray";const a=new Date,t=new Date(e);if(isNaN(t.getTime()))return"apple-badge-gray";const l=Math.ceil((t-a)/864e5);return l<0?"apple-badge-red":l<=7?"apple-badge-orange":l<=30?"apple-badge-yellow":"apple-badge-green"},Oa=()=>{oa.value={questionTitle:"",questionText:"",reviewDate:(new Date).toISOString().slice(0,10),categoriesId:"",keywords:[]},ra.value=""},Qa=()=>{(ra.value||"").split(/[;,\n]/).map(e=>e.trim()).filter(Boolean).forEach(e=>{oa.value.keywords.includes(e)||oa.value.keywords.push(e)}),ra.value=""},Na=async e=>{if(e?.QuestionsAnswersID){U.value=!0,la.value=!0,ua.value=e,Oa();try{await(async()=>{try{const e=await q.get("/questionsanswers/categories"),a=e.data?.data||e.data;ia.value=Array.isArray(a)?a:[]}catch(e){ia.value=[]}})();const a=await(async e=>{const a=await q.get("/questionsanswers");return(Array.isArray(a.data)?a.data:a.data?.data||[]).find(a=>String(a.QuestionsAnswersID)===String(e))||null})(e.QuestionsAnswersID);if(!a)return alert("ไม่พบคำถาม/คำตอบ"),void qa();const t=e=>{if(!e)return"";const a=String(e),t=ia.value.find(e=>String(e.CategoriesID)===a);if(t)return t.CategoriesID;const l=ia.value.find(e=>String(e.CategoriesName)===a);return l?l.CategoriesID:""};oa.value.questionTitle=a.QuestionTitle||"",oa.value.questionText=a.QuestionText||"",oa.value.reviewDate=a.ReviewDate?new Date(a.ReviewDate).toISOString().slice(0,10):(new Date).toISOString().slice(0,10),oa.value.categoriesId=t(a.CategoriesID||a.CategoryID||a.categoryId||a.CategoriesName||a.CategoryName)||"",oa.value.keywords=(a.keywords||[]).map(e=>e.KeywordText||e)}catch(a){alert("โหลดข้อมูลไม่สำเร็จ"),qa()}finally{la.value=!1}}},qa=()=>{U.value=!1,ua.value=null,Oa()},Ma=async()=>{if(ua.value)if(oa.value.questionTitle&&oa.value.questionText&&oa.value.categoriesId&&oa.value.reviewDate){sa.value=!0;try{const e={questionTitle:oa.value.questionTitle,questionText:oa.value.questionText,reviewDate:oa.value.reviewDate,categoriesId:oa.value.categoriesId,keywords:oa.value.keywords};await q.put(`/questionsanswers/update/${ua.value.QuestionsAnswersID}`,e),qa(),_a()}catch(e){const a=e.response?.data?.message||e.message||"บันทึกไม่สำเร็จ";alert(a)}finally{sa.value=!1}}else alert("กรอกข้อมูลให้ครบก่อนบันทึก")},_a=async()=>{_.value=!0,j.value=null;try{const e=await q.get("/getQuestionsAnswers");let a=Array.isArray(e.data)?e.data:e.data?.data||[];if(!Array.isArray(a)&&e.data&&!1===e.data.success)throw new Error(e.data.message||"Failed to load questions");const t=new Date,l=new Date;l.setDate(t.getDate()+R.daysThreshold),M.value=a.filter(e=>{if(!e.ReviewDate)return!1;return new Date(e.ReviewDate)<=l}).sort((e,a)=>e.ReviewDate?a.ReviewDate?new Date(e.ReviewDate)-new Date(a.ReviewDate):-1:1)}catch(e){e.response?j.value=e.response?.data?.message||e.message||"Failed to load data.":j.value="Network Error: Unable to reach backend."}finally{_.value=!1}};const ja=t(()=>{let e=M.value;if(fa.value.category&&(e=e.filter(e=>String(e.CategoriesID)===String(fa.value.category))),fa.value.status&&(e=e.filter(e=>function(e){if(!e.ReviewDate)return"no-date";const a=new Date(e.ReviewDate)-new Date,t=Math.ceil(a/864e5);return t<0?"overdue":t<=7?"urgent":"soon"}(e)===fa.value.status)),fa.value.dateFrom){const a=new Date(fa.value.dateFrom);a.setHours(0,0,0,0),e=e.filter(e=>!!e.ReviewDate&&new Date(e.ReviewDate)>=a)}if(fa.value.dateTo){const a=new Date(fa.value.dateTo);a.setHours(23,59,59,999),e=e.filter(e=>!!e.ReviewDate&&new Date(e.ReviewDate)<=a)}const a=(ma.value||"").toString().trim().toLowerCase();return a&&(e=e.filter(e=>{const t=String(e.QuestionsAnswersID||"").toLowerCase(),l=String(e.QuestionTitle||"").toLowerCase(),s=String(e.QuestionText||"").toLowerCase(),i=String(xa.value[e.CategoriesID]||"").toLowerCase();return t.includes(a)||l.includes(a)||s.includes(a)||i.includes(a)})),e}),Fa=t(()=>{const e=ja.value.slice(),{sortBy:a,sortOrder:t}=fa.value,l="asc"===t?1:-1;return e.sort((e,t)=>{let s=0;if("date"===a){s=(e?.ReviewDate?new Date(e.ReviewDate).getTime():0)-(t?.ReviewDate?new Date(t.ReviewDate).getTime():0)}else"id"===a?s=(e?.QuestionsAnswersID||0)-(t?.QuestionsAnswersID||0):"title"===a&&(s=(e?.QuestionTitle||"").localeCompare(t?.QuestionTitle||"","th"));return s*l})}),La=t(()=>Fa.value.length),Ea=t(()=>Math.max(1,Math.ceil(La.value/ya.value))),Ua=t(()=>0===La.value?0:(wa.value-1)*ya.value+1),Va=t(()=>{const e=wa.value*ya.value;return Math.min(e,La.value)}),Pa=t(()=>{const e=(wa.value-1)*ya.value,a=e+ya.value;return Fa.value.slice(e,a)}),Ba=t(()=>{const e=Ea.value,a=wa.value,t=[],l=[];for(let s=Math.max(2,a-2);s<=Math.min(e-1,a+2);s++)t.push(s);return a-2>2?l.push(1,"..."):l.push(1),l.push(...t),a+2<e-1?l.push("...",e):e>1&&l.push(e),l.filter((e,a,t)=>t.indexOf(e)===a&&"..."!==e||"..."===e)}),Wa=t(()=>M.value.filter(e=>!!e.ReviewDate&&new Date(e.ReviewDate)<new Date).length),Ha=t(()=>{const e=new Date,a=new Date;return a.setDate(e.getDate()+7),M.value.filter(t=>{if(!t.ReviewDate)return!1;const l=new Date(t.ReviewDate);return l>=e&&l<=a}).length}),Ka=t(()=>{const e={Overdue:0,Urgent:0,"Review Soon":0,"No Date":0};return M.value.forEach(a=>{const t=Ta(a);void 0!==e[t]?e[t]++:e["Review Soon"]++}),e}),za=t(()=>({labels:Object.keys(Ka.value),datasets:[{data:Object.values(Ka.value),backgroundColor:["#FF3B30","#FF9500","#FFCC00","#8E8E93"],borderWidth:0}]})),$a=t(()=>Object.values(Ka.value).reduce((e,a)=>e+(Number(a)||0),0)),Ga=t(()=>{const e={};return M.value.forEach(a=>{const t=xa.value[a.CategoriesID]||"Unknown";e[t]=(e[t]||0)+1}),e}),Ja=t(()=>({labels:Object.keys(Ga.value),datasets:[{label:"Questions by Category",data:Object.values(Ga.value),backgroundColor:Object.keys(Ga.value).map((e,a)=>Ia[a%Ia.length]),borderWidth:0,borderRadius:4}]})),Za=t(()=>Object.values(Ga.value).reduce((e,a)=>e+(Number(a)||0),0)),Xa={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{usePointStyle:!0,boxWidth:8}}},cutout:"70%"},Ya={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,grid:{borderDash:[4,4],color:"#f0f0f0"},ticks:{precision:0}},x:{grid:{display:!1}}}},et=()=>{S(()=>{[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map(e=>new Q(e))})};function at(){va&&(va.destroy(),va=null),pa&&(pa.destroy(),pa=null),S(()=>{$a.value>0&&ca.value&&za.value&&(va=new E(ca.value,{type:"doughnut",data:za.value,options:Xa})),Za.value>0&&da.value&&Ja.value&&(pa=new E(da.value,{type:"bar",data:Ja.value,options:Ya}))})}return l(Pa,()=>et()),l([$a,Za],()=>{_.value||j.value||at()}),l(M,()=>{_.value||j.value||at()},{deep:!0}),s(()=>{_a(),et(),ba=F(L.QUESTIONS_ANSWERS,{axios:q,onMessage:e=>{(e?.data?.action||e?.action||""||"QUESTION_ANSWER_UPDATE"===(e?.type||""))&&_a()},onOpen:()=>{ga.value=!0},onClose:()=>{ga.value=!1}})}),i(()=>{ba&&ba.disconnect(),va&&va.destroy(),pa&&pa.destroy()}),(e,a)=>(r(),n("div",V,[o("div",P,[o("div",B,[a[13]||(a[13]=c('<div class="d-flex align-items-center gap-3" data-v-2d38f492><div class="apple-icon-box orange-gradient" data-v-2d38f492><i class="bi bi-clipboard-check-fill text-white" data-v-2d38f492></i></div><div data-v-2d38f492><h3 class="page-title m-0" data-v-2d38f492>Review Pending</h3><span class="text-secondary small" data-v-2d38f492>Questions requiring update or verification</span></div></div>',1)),o("div",W,[o("div",{class:d(["apple-status-badge",{online:ga.value}])},[a[12]||(a[12]=o("span",{class:"status-dot"},null,-1)),o("span",null,v(ga.value?"Live":"Offline"),1)],2)])]),_.value?(r(),n("div",H,[...a[14]||(a[14]=[o("div",{class:"apple-spinner"},null,-1),o("p",{class:"mt-3 text-secondary"},"Checking for updates...",-1)])])):j.value?(r(),n("div",K,[a[15]||(a[15]=o("i",{class:"bi bi-exclamation-circle-fill me-2"},null,-1)),p(" "+v(j.value),1)])):(r(),n("div",z,[o("div",$,[o("div",G,[o("div",J,[a[17]||(a[17]=o("div",{class:"stat-icon-wrapper blue-gradient"},[o("i",{class:"bi bi-list-task"})],-1)),o("div",Z,[o("div",X,v(La.value),1),a[16]||(a[16]=o("div",{class:"stat-label"},"Total Pending",-1))])])]),o("div",Y,[o("div",ee,[a[19]||(a[19]=o("div",{class:"stat-icon-wrapper red-gradient"},[o("i",{class:"bi bi-exclamation-diamond-fill"})],-1)),o("div",ae,[o("div",te,v(Wa.value),1),a[18]||(a[18]=o("div",{class:"stat-label"},"Overdue",-1))])])]),o("div",le,[o("div",se,[a[21]||(a[21]=o("div",{class:"stat-icon-wrapper yellow-gradient"},[o("i",{class:"bi bi-hourglass-split"})],-1)),o("div",ie,[o("div",ne,v(Ha.value),1),a[20]||(a[20]=o("div",{class:"stat-label"},"Due Soon",-1))])])])]),o("div",re,[$a.value>0?(r(),n("div",oe,[o("div",ue,[a[22]||(a[22]=o("div",{class:"card-header-clean"},[o("h5",null,"Status Breakdown")],-1)),o("div",ce,[o("canvas",{ref_key:"pieCanvas",ref:ca},null,512)])])])):g("",!0),Za.value>0?(r(),n("div",de,[o("div",ve,[a[23]||(a[23]=o("div",{class:"card-header-clean"},[o("h5",null,"By Category")],-1)),o("div",pe,[o("canvas",{ref_key:"barCanvas",ref:da},null,512)])])])):g("",!0)]),o("div",ge,[o("div",be,[o("div",me,[a[24]||(a[24]=o("span",{class:"label"},"Items",-1)),a[25]||(a[25]=o("span",{class:"separator"},"|",-1)),o("span",we,v(La.value),1)]),o("div",ye,[a[27]||(a[27]=o("i",{class:"bi bi-search search-icon"},null,-1)),b(o("input",{type:"text",class:"search-input",placeholder:"Search items...","onUpdate:modelValue":a[0]||(a[0]=e=>ma.value=e)},null,512),[[m,ma.value]]),ma.value?(r(),n("button",{key:0,class:"search-clear",onClick:a[1]||(a[1]=e=>ma.value="")},[...a[26]||(a[26]=[o("i",{class:"bi bi-x-circle-fill"},null,-1)])])):g("",!0)])]),u(A,{modelValue:fa.value,"onUpdate:modelValue":a[2]||(a[2]=e=>fa.value=e),"show-sort":!0,"sort-options":ha,"default-sort-by":"date","default-sort-order":"asc",categories:Ca.value,"category-label":"หมวดหมู่",statuses:Da,"status-label":"สถานะ","show-date-presets":!0,onChange:ka},null,8,["modelValue","categories"]),o("div",fe,[o("table",he,[a[29]||(a[29]=o("thead",null,[o("tr",null,[o("th",{class:"ps-4"},"ID"),o("th",null,"Question Title"),o("th",null,"Review Date"),o("th",null,"Category"),o("th",null,"Status")])],-1)),o("tbody",null,[(r(!0),n(w,null,y(Pa.value,e=>{return r(),n("tr",{key:e.QuestionsAnswersID,class:"align-middle apple-row clickable-row",onClick:a=>Na(e)},[o("td",Ce,v(e.QuestionsAnswersID),1),o("td",ke,[o("div",{class:"question-text-cell fw-medium text-dark",title:e.QuestionTitle},v(e.QuestionTitle),9,xe)]),o("td",Ie,[o("span",{class:d(["apple-badge",Aa(e.ReviewDate)]),"data-bs-toggle":"tooltip","data-bs-placement":"top",title:Sa(e.ReviewDate)},v(f(O)(e.ReviewDate)),11,Se)]),o("td",Te,[o("span",{class:"tag-badge",style:h({backgroundColor:(a=e.CategoriesID,Ia[(a||0)%Ia.length])})},v(xa.value[e.CategoriesID]||e.CategoriesID),5)]),o("td",Re,[o("span",{class:d(Ra(e))},v(Ta(e)),3)])],8,De);var a}),128)),0===ja.value.length?(r(),n("tr",Ae,[...a[28]||(a[28]=[o("td",{colspan:"5",class:"text-center text-muted py-5"},[o("div",{class:"empty-state"},[o("i",{class:"bi bi-check2-circle"}),o("p",null,"All questions are up to date")])],-1)])])):g("",!0)])])]),o("div",Oe,[o("div",Qe," Showing "+v(Ua.value)+" - "+v(Va.value)+" of "+v(La.value),1),o("nav",Ne,[o("ul",qe,[o("li",{class:d(["page-item",{disabled:1===wa.value}])},[o("a",{class:"page-link",href:"#",onClick:a[3]||(a[3]=D(e=>wa.value=1,["prevent"]))},"«")],2),o("li",{class:d(["page-item",{disabled:1===wa.value}])},[o("a",{class:"page-link",href:"#",onClick:a[4]||(a[4]=D(e=>wa.value=Math.max(1,wa.value-1),["prevent"]))},"‹")],2),(r(!0),n(w,null,y(Ba.value,e=>(r(),n("li",{key:e,class:d(["page-item",{active:wa.value===e}])},[o("a",{class:"page-link page-num",href:"#",onClick:D(a=>wa.value=e,["prevent"])},v(e),9,Me)],2))),128)),o("li",{class:d(["page-item",{disabled:wa.value===Ea.value}])},[o("a",{class:"page-link",href:"#",onClick:a[5]||(a[5]=D(e=>wa.value=Math.min(Ea.value,wa.value+1),["prevent"]))},"›")],2),o("li",{class:d(["page-item",{disabled:wa.value===Ea.value}])},[o("a",{class:"page-link",href:"#",onClick:a[6]||(a[6]=D(e=>wa.value=Ea.value,["prevent"]))},"»")],2)])])])])]))]),u(I,{name:"apple-zoom"},{default:C(()=>[U.value?(r(),n("div",{key:0,class:"apple-modal-overlay",onClick:D(qa,["self"])},[o("div",_e,[a[43]||(a[43]=o("div",{class:"apple-modal-header-bg"},null,-1)),o("div",{class:"apple-modal-header"},[a[31]||(a[31]=o("div",{class:"d-flex flex-column"},[o("h5",{class:"apple-modal-title"},"Edit Question"),o("span",{class:"apple-modal-subtitle"},"Update review details inline")],-1)),o("button",{class:"apple-close-btn",onClick:qa,"aria-label":"Close"},[...a[30]||(a[30]=[o("i",{class:"bi bi-x-lg"},null,-1)])])]),o("div",je,[la.value?(r(),n("div",Fe,[...a[32]||(a[32]=[o("div",{class:"apple-spinner mx-auto mb-3"},null,-1),o("p",{class:"text-secondary"},"Loading details...",-1)])])):(r(),n("div",Le,[o("div",Ee,[a[33]||(a[33]=o("label",null,"Question Title",-1)),b(o("input",{type:"text",class:"apple-input","onUpdate:modelValue":a[7]||(a[7]=e=>oa.value.questionTitle=e)},null,512),[[m,oa.value.questionTitle]])]),o("div",Ue,[a[34]||(a[34]=o("label",null,"Question Text",-1)),b(o("textarea",{class:"apple-input apple-textarea",rows:"4","onUpdate:modelValue":a[8]||(a[8]=e=>oa.value.questionText=e)},null,512),[[m,oa.value.questionText]])]),o("div",Ve,[o("div",Pe,[o("div",Be,[a[35]||(a[35]=o("label",null,"Review Date",-1)),b(o("input",{type:"date",class:"apple-input","onUpdate:modelValue":a[9]||(a[9]=e=>oa.value.reviewDate=e)},null,512),[[m,oa.value.reviewDate]])])]),o("div",We,[o("div",He,[a[38]||(a[38]=o("label",null,"Category",-1)),o("div",Ke,[b(o("select",{class:"apple-input","onUpdate:modelValue":a[10]||(a[10]=e=>oa.value.categoriesId=e)},[a[36]||(a[36]=o("option",{value:""},"-- Select Category --",-1)),(r(!0),n(w,null,y(na.value,e=>(r(),n("option",{key:e.CategoriesID,value:e.CategoriesID,class:d(e.isMain?"fw-bold text-muted bg-light":""),disabled:e.isMain},v(e.isMain?"▸ ":"  └ ")+v(e.CategoriesName||e.CategoriesID),11,ze))),128))],512),[[k,oa.value.categoriesId]]),a[37]||(a[37]=o("i",{class:"bi bi-chevron-down select-icon"},null,-1))])])])]),o("div",$e,[a[41]||(a[41]=o("label",null,"Keywords (comma separated)",-1)),o("div",Ge,[b(o("input",{type:"text",class:"apple-input","onUpdate:modelValue":a[11]||(a[11]=e=>ra.value=e),onKeyup:x(D(Qa,["prevent"]),["enter"]),placeholder:"Type and press Enter...",style:{"padding-right":"40px"}},null,40,Je),[[m,ra.value]]),o("button",{class:"apple-icon-btn-abs",onClick:Qa,title:"Add keyword"},[...a[39]||(a[39]=[o("i",{class:"bi bi-plus-lg"},null,-1)])])]),o("div",Ze,[(r(!0),n(w,null,y(oa.value.keywords,(e,t)=>(r(),n("span",{key:e+t,class:"keyword-tag removable",onClick:e=>(e=>{oa.value.keywords.splice(e,1)})(t)},[p(v(e)+" ",1),a[40]||(a[40]=o("i",{class:"bi bi-x ms-1"},null,-1))],8,Xe))),128))])]),o("div",Ye,[o("button",{class:"btn-apple-secondary",onClick:qa,disabled:sa.value},"Cancel",8,ea),o("button",{class:"btn-apple-primary",onClick:Ma,disabled:sa.value},[sa.value?(r(),n("span",ta)):g("",!0),a[42]||(a[42]=p(" Save & Mark Reviewed ",-1))],8,aa)])]))])])])):g("",!0)]),_:1})]))}},[["__scopeId","data-v-2d38f492"]]),sa={class:"report-page-container"},ia={class:"main-content flex-grow-1"},na={class:"apple-dashboard"},ra={class:"dashboard-hero"},oa={class:"hero-content"},ua=["aria-label"],ca={class:"reports-grid"},da=R({__name:"QuestionsNeedReviewReportView",setup(l){E.register(...U);const c=T(),{appContext:d}=e(),{$axios:v}=d.config.globalProperties,p=a({}),b=a(""),m=a([]);let w=null;const y=()=>{const e=document.querySelector(".sidebar");!q.value?(w=j.value,j.value=!1,e&&e.classList.remove("collapsed"),document.body.classList.add("sidebar-open"),document.body.classList.add("sidebar-mobile-expanded"),q.value=!0):(j.value=!!w,e&&w&&e.classList.add("collapsed"),document.body.classList.remove("sidebar-open"),document.body.classList.remove("sidebar-mobile-expanded"),q.value=!1,w=null)},h=t(()=>{const e={};return m.value.forEach(a=>{e[a.CategoriesID]=a.CategoriesName}),e}),C=e=>{if(!e)return"-";return new Date(e).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric"})};let k=null;return s(()=>{k=N();const e=localStorage.getItem("userToken"),a=localStorage.getItem("userType"),t=localStorage.getItem("userInfo");if(e){if(a&&(b.value=a),t)try{p.value=JSON.parse(t)}catch(l){}(async()=>{try{let e=(await v.get("/getcategories")).data;e&&!Array.isArray(e)&&Array.isArray(e.categories)&&(e=e.categories),m.value=e}catch(e){}})()}else c.replace({name:"login"})}),i(()=>{"function"==typeof k&&k(),q.value=!1,document.body.classList.remove("sidebar-open"),document.body.classList.remove("sidebar-mobile-expanded")}),(e,a)=>(r(),n("div",sa,[u(M,{userType:b.value,userInfoObject:p.value},null,8,["userType","userInfoObject"]),f(q)?(r(),n("div",{key:0,class:"mobile-sidebar-backdrop",onClick:y,"aria-hidden":"true"})):g("",!0),o("main",ia,[o("div",na,[o("div",ra,[o("div",oa,[o("button",{class:"mobile-sidebar-toggle mobile-inline-toggle",onClick:D(y,["stop"]),"aria-label":f(q)?"Close sidebar":"Open sidebar"},[u(_,{isOpen:f(q)},null,8,["isOpen"])],8,ua),a[0]||(a[0]=o("h1",{class:"hero-title"},"Questions Need Review",-1)),a[1]||(a[1]=o("p",{class:"hero-subtitle"},"คำถามที่ต้องทบทวน",-1))])]),o("div",ca,[u(la,{categoriesNameMap:h.value,formatThaiDateTime:C,daysThreshold:30},null,8,["categoriesNameMap"])])])])]))}},[["__scopeId","data-v-4c0fc899"]]);export{da as default};
