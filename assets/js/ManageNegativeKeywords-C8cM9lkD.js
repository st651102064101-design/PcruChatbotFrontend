import{f as e,r as a,j as s,l as t,g as l,H as i,c as d,o,a as c,p as r,d as n,u,h as v,m as b,z as p,n as g,t as m,i as w,s as f,G as y,K as h,F as k,b as x,x as I,y as M}from"./vue-vendor-CaqZERVf.js";import{_ as C,b as L,d as $,i as D,S as q,A,a as K}from"./index-YNQFrYK5.js";import"./axios-vendor-Dos3PyFQ.js";const N={class:"dashboard-container"},S={class:"main-content"},W={class:"negative-keywords-container"},V={class:"header-section my-4"},j={class:"header-top d-flex align-items-center gap-3 mb-3",style:{"justify-content":"space-between"}},B={class:"d-flex align-items-center gap-3"},U=["aria-label"],E={class:"header-actions d-flex gap-2"},T=["disabled"],O={key:0,class:"deleted-badge"},z=["disabled"],P={class:"stats-row slide-in-up",style:{animationDelay:"0.1s"}},_={class:"stat-card"},H={class:"stat-value"},F={class:"stat-card"},G={class:"stat-value text-success"},J={class:"stat-card"},R={class:"stat-value text-danger"},Q={class:"stat-card"},X={class:"stat-value text-warning"},Y={class:"form-card slide-in-left",style:{animationDelay:"0.15s"}},Z={class:"form-row"},ee={class:"form-group flex-grow-1"},ae={class:"form-group form-group-modifier"},se={class:"form-group form-group-description"},te={class:"form-group form-group-button"},le=["disabled"],ie={class:"filter-card slide-in-right",style:{animationDelay:"0.2s"}},de={class:"filter-row"},oe={class:"search-box"},ce={class:"table-card slide-in-up",style:{animationDelay:"0.25s"}},re={class:"table-responsive"},ne={class:"keywords-table"},ue={key:0},ve={key:1},be={class:"text-muted","data-label":"#"},pe={"data-label":"คำปฏิเสธ"},ge={key:0,class:"keyword-word"},me={"data-label":"คำอธิบาย"},we={key:0,class:"text-muted"},fe={"data-label":"สถานะ"},ye=["onClick","title"],he={"data-label":"จัดการ"},ke={class:"action-buttons"},xe=["onClick"],Ie=["onClick"],Me=["onClick"],Ce={key:0,class:"pagination-wrapper"},Le=["disabled"],$e={class:"page-info"},De=["disabled"],qe={key:0,class:"toast-container"},Ae={class:"modal-content pop-in"},Ke={class:"modal-text"},Ne={class:"modal-actions"},Se=["disabled"],We={class:"modal-content seed-modal-content pop-in"},Ve={key:0,class:"seed-loading"},je={key:1,class:"seed-preview"},Be={key:0,class:"seed-section"},Ue={class:"seed-section-title text-success"},Ee={class:"seed-words-list"},Te={class:"modifier"},Oe={key:1,class:"seed-section"},ze={class:"seed-section-title text-muted"},Pe={class:"seed-words-list"},_e={key:2,class:"seed-section"},He={class:"seed-section-title text-warning"},Fe={class:"seed-words-list"},Ge={key:3,class:"seed-empty"},Je={class:"modal-actions"},Re=["disabled"],Qe={class:"recently-deleted-modal pop-in"},Xe={class:"rd-header"},Ye={class:"rd-header-left"},Ze={class:"rd-header-right"},ea={key:0,class:"rd-info-banner"},aa={class:"rd-content"},sa={key:0,class:"rd-loading"},ta={key:1,class:"rd-empty"},la={key:2,class:"rd-grid"},ia=["onClick"],da={key:0,class:"rd-item-select"},oa={class:"rd-item-content"},ca={class:"rd-word"},ra={class:"rd-date"},na={key:1,class:"rd-item-actions"},ua=["onClick"],va=["onClick"],ba={key:1,class:"rd-footer"},pa=["disabled"],ga=["disabled"],ma={key:2,class:"rd-footer"},wa={class:"modal-content pop-in"},fa={class:"modal-text"},ya={class:"modal-actions"},ha=["disabled"],ka=C({__name:"ManageNegativeKeywords",setup(C){const ka=e(),xa=a({}),Ia=a(""),Ma=a(window.innerWidth<=768);let Ca=null;const La=()=>{const e=document.querySelector(".sidebar");!D.value?(Ca=K.value,K.value=!1,e&&e.classList.remove("collapsed"),document.body.classList.add("sidebar-open"),document.body.classList.add("sidebar-mobile-expanded"),D.value=!0):(K.value=!!Ca,e&&Ca&&e.classList.add("collapsed"),document.body.classList.remove("sidebar-open"),document.body.classList.remove("sidebar-mobile-expanded"),D.value=!1,Ca=null)},$a=a([]),Da=a([]),qa=a({}),Aa=a({page:1,limit:5,total:0,totalPages:1}),Ka=a("");a(void 0);const Na=a(!1),Sa=a(!1),Wa=a(!1),Va=a(!1),ja=a(null),Ba=a({sortBy:"id",sortOrder:"asc",status:""}),Ua=[{value:"id",label:"ID"},{value:"word",label:"คำ"},{value:"modifier",label:"ตัวคูณ"}],Ea=[{value:"active",label:"ใช้งาน",icon:"bi bi-check-circle-fill",color:"status-green"},{value:"inactive",label:"ปิดใช้งาน",icon:"bi bi-x-circle",color:"status-gray"}],Ta=()=>{Aa.value.page=1,es()},Oa=s({show:!1,loading:!1,toAdd:[],alreadyExists:[],ignored:[],totalStandard:0}),za=s({show:!1,items:[],selectMode:!1,selectedIds:[]}),Pa=a(0),_a=a(!1),Ha=a(!1),Fa=s({show:!1}),Ga=s({word:"",weightModifier:-1,description:""}),Ja=s({word:"",weightModifier:-1,description:""}),Ra=s({show:!1,keyword:null}),Qa=s({show:!1,message:"",type:"success"}),Xa=t(()=>{const e={success:"bi bi-check-circle-fill",error:"bi bi-x-circle-fill",warning:"bi bi-exclamation-circle-fill"};return e[Qa.type]||e.success});let Ya;const Za=()=>{clearTimeout(Ya),Ya=setTimeout(()=>{Aa.value.page=1,es()},300)},es=async()=>{Na.value=!0;try{const e=new URLSearchParams({page:Aa.value.page,limit:Aa.value.limit,search:Ka.value});"active"===Ba.value.status?e.append("active",1):"inactive"===Ba.value.status&&e.append("active",0),Ba.value.sortBy&&(e.append("sortBy",Ba.value.sortBy),e.append("sortOrder",Ba.value.sortOrder));const a=await $.get(`/negativekeywords?${e}`);a.data.ok&&($a.value=a.data.data,Aa.value=a.data.pagination,qa.value=a.data.stats)}catch(e){ms("ไม่สามารถโหลดข้อมูลได้: "+e.message,"error")}finally{Na.value=!1}},as=async()=>{if(!Ga.word.trim())return;const e=Ga.word.includes(",")?Ga.word.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e):[Ga.word.trim().toLowerCase()],a=new Set(Da.value.map(e=>(e.KeywordText||"").toLowerCase())),s=e.filter(e=>a.has(e));if(s.length>0)ms(`ไม่สามารถเพิ่มได้: "${s.join(", ")}" เป็น Keyword อยู่แล้ว`,"error");else{Sa.value=!0;try{const e=Ga.word.includes(","),a=e?"/negativekeywords/bulk":"/negativekeywords",s=e?{words:Ga.word,weightModifier:Ga.weightModifier}:{word:Ga.word,weightModifier:Ga.weightModifier,description:Ga.description},t=await $.post(a,s);t.data.ok&&(ms(t.data.message,"success"),Ga.word="",Ga.description="",es())}catch(t){ms(t.response?.data?.message||t.message,"error")}finally{Sa.value=!1}}},ss=()=>{ja.value=null},ts=async()=>{Oa.show=!0,Oa.loading=!0,Oa.toAdd=[],Oa.alreadyExists=[],Oa.ignored=[];try{const e=await $.get("/negativekeywords/seed/preview");e.data&&e.data.ok&&(Oa.toAdd=e.data.data.toAdd||[],Oa.alreadyExists=e.data.data.alreadyExists||[],Oa.ignored=e.data.data.ignored||[],Oa.totalStandard=e.data.data.totalStandard||0)}catch(e){ms("ไม่สามารถโหลดรายการคำได้","error")}finally{Oa.loading=!1}},ls=async()=>{Va.value=!0;try{const e=await $.post("/negativekeywords/seed");if(e.data&&e.data.ok){const a=e.data.addedCount||0;a>0?ms(`เติมข้อมูลสำเร็จ! เพิ่มคำใหม่ ${a} คำ`,"success"):ms("ข้อมูลเป็นปัจจุบันอยู่แล้ว ไม่มีคำใหม่ที่ต้องเพิ่ม","warning"),Oa.show=!1,Aa.value.page=1,await es()}else ms(e.data?.message||"ไม่สามารถเติมคำได้","error")}catch(e){ms(e.response?.data?.message||e.message||"เกิดข้อผิดพลาดในการเติมข้อมูล","error")}finally{Va.value=!1}},is=async()=>{try{const e=await $.get("/negativekeywords/deleted");e.data&&e.data.ok&&(Pa.value=e.data.total||0)}catch(e){}},ds=async()=>{za.show=!0,za.selectMode=!1,za.selectedIds=[],_a.value=!0;try{const e=await $.get("/negativekeywords/deleted");e.data&&e.data.ok&&(za.items=e.data.data||[],Pa.value=e.data.total||0)}catch(e){ms("ไม่สามารถโหลดรายการคำที่ลบได้","error")}finally{_a.value=!1}},os=()=>{za.selectMode=!za.selectMode,za.selectMode||(za.selectedIds=[])},cs=e=>{if(!e)return"";const a=new Date(e),s=new Date-a,t=Math.floor(s/864e5);return 0===t?"วันนี้":1===t?"เมื่อวาน":t<7?`${t} วันที่แล้ว`:t<30?`${Math.floor(t/7)} สัปดาห์ที่แล้ว`:a.toLocaleDateString("th-TH",{day:"numeric",month:"short",year:"numeric"})},rs=async()=>{if(0===za.selectedIds.length)return;let e=0;for(const s of za.selectedIds)try{const a=await $.post(`/negativekeywords/restore/${s}`);a.data&&a.data.ok&&e++}catch(a){}ms(`กู้คืนสำเร็จ ${e} คำ`,"success"),za.selectedIds=[],za.selectMode=!1,await ds(),await es()},ns=async()=>{if(0===za.selectedIds.length)return;if(!confirm(`ลบถาวร ${za.selectedIds.length} คำ? ไม่สามารถกู้คืนได้อีก`))return;let e=0;for(const s of za.selectedIds)try{const a=await $.delete(`/negativekeywords/deleted/${s}`);a.data&&a.data.ok&&e++}catch(a){}ms(`ลบถาวร ${e} คำแล้ว`,"success"),za.selectedIds=[],za.selectMode=!1,await ds()},us=async()=>{if(confirm(`กู้คืนทั้งหมด ${za.items.length} คำ?`))try{const e=await $.post("/negativekeywords/restore-all");e.data&&e.data.ok?(ms(e.data.message,"success"),za.items=[],Pa.value=0,await es()):ms(e.data?.message||"ไม่สามารถกู้คืนได้","error")}catch(e){ms(e.response?.data?.message||"เกิดข้อผิดพลาด","error")}},vs=()=>{Fa.show=!0},bs=async()=>{Ha.value=!0;try{const e=await $.delete("/negativekeywords/deleted-all");e.data&&e.data.ok?(ms(e.data.message,"success"),za.items=[],Pa.value=0,Fa.show=!1):ms(e.data?.message||"ไม่สามารถลบได้","error")}catch(e){ms(e.response?.data?.message||"เกิดข้อผิดพลาด","error")}finally{Ha.value=!1}},ps=async()=>{if(Ra.keyword){Wa.value=!0;try{const e=await $.delete(`/negativekeywords/${Ra.keyword.NegativeKeywordID}`);if(e.data&&e.data.ok)ms(e.data.message,"success"),Ra.show=!1,Ra.keyword=null,Aa.value.page=1,await es(),await is();else{const a=e.data?.message||"เกิดข้อผิดพลาดในการลบ";ms(a,"error")}}catch(e){const a=e.response?.data?.message||e.message||"ไม่สามารถลบได้";ms(a,"error")}finally{Wa.value=!1}}},gs=e=>{Aa.value.page=e,es()},ms=(e,a="success")=>{Qa.message=e,Qa.type=a,Qa.show=!0,setTimeout(()=>{Qa.show=!1},3e3)};return l(async()=>{const e=localStorage.getItem("userToken"),a=localStorage.getItem("userType"),s=localStorage.getItem("userInfo");if(!e)return void ka.replace({name:"login"});if(a&&(Ia.value=a),s)try{xa.value=JSON.parse(s)}catch(l){}L(),es(),is();try{const e=await $.get("/keywords/public");Da.value=e.data?.data||e.data||[]}catch(l){}const t=()=>{Ma.value=window.innerWidth<=768};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}}),i(()=>{D.value=!1,document.body.classList.remove("sidebar-open"),document.body.classList.remove("sidebar-mobile-expanded")}),(e,a)=>(o(),d("div",N,[c(q,{userType:Ia.value,userInfoObject:xa.value},null,8,["userType","userInfoObject"]),u(D)?(o(),d("div",{key:0,class:"mobile-sidebar-backdrop",onClick:La,"aria-hidden":"true"})):r("",!0),n("main",S,[n("div",W,[n("div",V,[n("div",j,[n("div",B,[n("button",{class:"mobile-sidebar-toggle mobile-inline-toggle",onClick:p(La,["stop"]),"aria-label":u(D)?"Close sidebar":"Open sidebar"},[n("i",{class:g(u(D)?"bi bi-x":"bi bi-list")},null,2)],8,U),a[18]||(a[18]=v('<svg class="brain-icon" width="40" height="40" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-44fc0e2b><circle cx="32" cy="32" r="30" fill="#dc2626" opacity="0.08" data-v-44fc0e2b></circle><circle class="brain-outline brain-left" cx="32" cy="32" r="18" stroke="#dc2626" stroke-width="3" stroke-linecap="round" fill="none" data-v-44fc0e2b></circle><path class="brain-wrinkle wrinkle-1" d="M 18 18 L 46 46" stroke="#dc2626" stroke-width="3" stroke-linecap="round" fill="none" data-v-44fc0e2b></path><path class="brain-wrinkle wrinkle-2" d="M 46 18 L 18 46" stroke="#dc2626" stroke-width="3" stroke-linecap="round" fill="none" data-v-44fc0e2b></path><g class="neuron-group" data-v-44fc0e2b><circle class="neuron-glow" cx="20" cy="20" r="5" fill="#dc2626" opacity="0.2" data-v-44fc0e2b></circle><circle class="neuron neuron-1" cx="20" cy="20" r="2.5" fill="#dc2626" data-v-44fc0e2b></circle></g><g class="neuron-group" data-v-44fc0e2b><circle class="neuron-glow" cx="44" cy="44" r="5" fill="#ef4444" opacity="0.2" data-v-44fc0e2b></circle><circle class="neuron neuron-2" cx="44" cy="44" r="2.5" fill="#ef4444" data-v-44fc0e2b></circle></g></svg><h2 class="page-title m-0" data-v-44fc0e2b>Manage Negative Keywords</h2>',2))]),n("div",E,[n("button",{class:"btn-deleted",onClick:ds,disabled:_a.value,title:"คำที่ลบล่าสุด"},[a[19]||(a[19]=n("i",{class:"bi bi-trash3"},null,-1)),Pa.value>0?(o(),d("span",O,m(Pa.value),1)):r("",!0)],8,T),n("button",{class:"btn-seed",onClick:ts,disabled:Va.value,title:"เติมคำมาตรฐานอัตโนมัติ"},[...a[20]||(a[20]=[n("i",{class:"bi bi-magic"},null,-1),n("span",{class:"d-none d-sm-inline"},"เติมอัตโนมัติ",-1)])],8,z)])])]),a[69]||(a[69]=v('<div class="info-card apple-card mb-4 p-4 rounded-4 shadow-apple" data-v-44fc0e2b><svg class="book-icon float-start me-3" width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-44fc0e2b><circle cx="36" cy="36" r="32" fill="#dc2626" opacity="0.08" data-v-44fc0e2b></circle><circle cx="36" cy="36" r="20" stroke="#dc2626" stroke-width="2.5" fill="none" data-v-44fc0e2b></circle><path d="M 22 22 L 50 50" stroke="#dc2626" stroke-width="3" stroke-linecap="round" data-v-44fc0e2b></path><path d="M 50 22 L 22 50" stroke="#dc2626" stroke-width="3" stroke-linecap="round" data-v-44fc0e2b></path><circle cx="24" cy="24" r="3" fill="#dc2626" opacity="0.6" data-v-44fc0e2b></circle><circle cx="48" cy="48" r="3" fill="#ef4444" opacity="0.6" data-v-44fc0e2b></circle></svg><h5 class="fw-bold mb-3" data-v-44fc0e2b>Negative Keywords คืออะไร?</h5><p class="mb-2 text-muted" data-v-44fc0e2b><strong data-v-44fc0e2b>Negative Keywords</strong> คือคำที่ทำให้คะแนนลดลง หรือเป็นคำปฏิเสธที่ไม่ต้องการให้ระบบนำไปใช้ เช่น &quot;ไม่&quot;, &quot;ยกเว้น&quot;, &quot;อย่า&quot; เพื่อให้การค้นหาแม่นยำขึ้น</p><ul class="mb-3 text-muted small" data-v-44fc0e2b><li class="d-flex align-items-center gap-2 mb-2" data-v-44fc0e2b><svg class="icon-svg" width="20" height="20" viewBox="0 0 20 20" fill="none" data-v-44fc0e2b><circle cx="10" cy="10" r="8" stroke="#dc2626" stroke-width="2" data-v-44fc0e2b></circle><path d="M6 10 L14 10" stroke="#dc2626" stroke-width="2" stroke-linecap="round" data-v-44fc0e2b></path></svg><span data-v-44fc0e2b>คำปฏิเสธจะลดคะแนนของผลลัพธ์ที่ค้นหา</span></li><li class="d-flex align-items-center gap-2 mb-2" data-v-44fc0e2b><svg class="icon-svg" width="20" height="20" viewBox="0 0 20 20" fill="none" data-v-44fc0e2b><circle cx="10" cy="10" r="8" stroke="#dc2626" stroke-width="2" data-v-44fc0e2b></circle><path d="M6 10 L9 13 L14 7" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-44fc0e2b></path></svg><span data-v-44fc0e2b>ปรับตัวคูณคะแนน: -1.0 (ลบ), 0.0 (ศูนย์), -0.5 (ลดครึ่ง)</span></li><li class="d-flex align-items-center gap-2" data-v-44fc0e2b><svg class="icon-svg" width="20" height="20" viewBox="0 0 20 20" fill="none" data-v-44fc0e2b><circle cx="10" cy="10" r="8" stroke="#dc2626" stroke-width="2" data-v-44fc0e2b></circle><path d="M10 6 V10 L13 13" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-44fc0e2b></path></svg><span data-v-44fc0e2b>เพิ่ม/ลบ/แก้ไข negative keywords ได้ตลอด</span></li></ul><p class="mb-0 small text-danger fw-bold d-flex align-items-center gap-2" data-v-44fc0e2b><svg class="icon-svg" width="20" height="20" viewBox="0 0 20 20" fill="none" data-v-44fc0e2b><circle cx="10" cy="10" r="8" stroke="#dc2626" stroke-width="2" data-v-44fc0e2b></circle><path d="M10 6 L10 11" stroke="#ffd60a" stroke-width="2" stroke-linecap="round" data-v-44fc0e2b></path><path d="M8 14 L12 14" stroke="#dc2626" stroke-width="2" stroke-linecap="round" data-v-44fc0e2b></path><circle cx="10" cy="8" r="4" fill="#ffd60a" opacity="0.3" data-v-44fc0e2b></circle></svg><span data-v-44fc0e2b>ใช้ &quot;เติมคำมาตรฐานอัตโนมัติ&quot; เพื่อโหลดข้อมูลเริ่มต้น</span></p></div>',1)),n("div",P,[n("div",_,[n("div",H,m(qa.value.total||0),1),a[21]||(a[21]=n("div",{class:"stat-label"},"คำทั้งหมด",-1))]),n("div",F,[n("div",G,m(qa.value.active||0),1),a[22]||(a[22]=n("div",{class:"stat-label"},"ใช้งานอยู่",-1))]),n("div",J,[n("div",R,m(qa.value.negativeModifier||0),1),a[23]||(a[23]=n("div",{class:"stat-label"},"ตัวคูณ -1.0",-1))]),n("div",Q,[n("div",X,m(qa.value.zeroModifier||0),1),a[24]||(a[24]=n("div",{class:"stat-label"},"ตัวคูณ 0.0",-1))])]),n("div",Y,[a[31]||(a[31]=n("h2",{class:"card-title"},[n("i",{class:"bi bi-plus-circle me-2"}),w(" เพิ่มคำปฏิเสธ ")],-1)),n("form",{onSubmit:p(as,["prevent"]),class:"add-form"},[n("div",Z,[n("div",ee,[a[25]||(a[25]=n("label",{class:"form-label"},"คำปฏิเสธ",-1)),f(n("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>Ga.word=e),class:"form-control",placeholder:"เช่น ไม่, ยกเว้น, อย่า, ห้าม",required:""},null,512),[[y,Ga.word]]),a[26]||(a[26]=n("small",{class:"form-hint"},"ใส่หลายคำได้ คั่นด้วยเครื่องหมาย , (comma)",-1))]),n("div",ae,[a[28]||(a[28]=n("label",{class:"form-label"},"ตัวคูณคะแนน",-1)),f(n("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>Ga.weightModifier=e),class:"form-control"},[...a[27]||(a[27]=[n("option",{value:-1},"-1.0 (กลับเป็นลบ)",-1),n("option",{value:0},"0.0 (ทำให้เป็นศูนย์)",-1),n("option",{value:-.5},"-0.5 (ลดครึ่งหนึ่ง)",-1)])],512),[[h,Ga.weightModifier]])]),n("div",se,[a[29]||(a[29]=n("label",{class:"form-label"},"คำอธิบาย (ไม่บังคับ)",-1)),f(n("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=e=>Ga.description=e),class:"form-control",placeholder:"อธิบายการใช้งาน"},null,512),[[y,Ga.description]])]),n("div",te,[n("button",{type:"submit",class:"btn-primary-apple",disabled:!Ga.word.trim()||Sa.value},[a[30]||(a[30]=n("i",{class:"bi bi-plus-lg me-1"},null,-1)),w(" "+m(Sa.value?"กำลังเพิ่ม...":"เพิ่ม"),1)],8,le)])])],32)]),c(A,{modelValue:Ba.value,"onUpdate:modelValue":a[3]||(a[3]=e=>Ba.value=e),"sort-options":Ua,statuses:Ea,"status-label":"สถานะ","show-date-range":!1,"show-date-presets":!1,"show-number-range":!1,class:"mb-4",onChange:Ta},null,8,["modelValue"]),n("div",ie,[n("div",de,[n("div",oe,[a[32]||(a[32]=n("i",{class:"bi bi-search"},null,-1)),f(n("input",{type:"text","onUpdate:modelValue":a[4]||(a[4]=e=>Ka.value=e),placeholder:"ค้นหาคำปฏิเสธ...",onInput:Za},null,544),[[y,Ka.value]])])])]),n("div",ce,[n("div",re,[n("table",ne,[a[40]||(a[40]=n("thead",null,[n("tr",null,[n("th",{style:{width:"60px"}},"#"),n("th",null,"คำปฏิเสธ"),n("th",{style:{width:"150px"}},"ตัวคูณ"),n("th",null,"คำอธิบาย"),n("th",{style:{width:"100px"}},"สถานะ"),n("th",{style:{width:"150px"}},"จัดการ")])],-1)),n("tbody",null,[Na.value?(o(),d("tr",ue,[...a[33]||(a[33]=[n("td",{colspan:"6",class:"text-center py-4"},[n("div",{class:"loading-spinner"}),n("p",{class:"mt-2 text-muted"},"กำลังโหลด...")],-1)])])):0===$a.value.length?(o(),d("tr",ve,[...a[34]||(a[34]=[n("td",{colspan:"6",class:"text-center py-4"},[n("i",{class:"bi bi-inbox text-muted",style:{"font-size":"3rem"}}),n("p",{class:"mt-2 text-muted"},"ไม่พบคำปฏิเสธ")],-1)])])):r("",!0),(o(!0),d(k,null,x($a.value,(e,s)=>{return o(),d("tr",{key:e.NegativeKeywordID,class:"keyword-row pop-in",style:M({animationDelay:.05*s+"s"})},[n("td",be,m((Aa.value.page-1)*Aa.value.limit+s+1),1),n("td",pe,[ja.value!==e.NegativeKeywordID?(o(),d("span",ge,m(e.Word),1)):f((o(),d("input",{key:1,"onUpdate:modelValue":a[5]||(a[5]=e=>Ja.word=e),class:"form-control form-control-sm"},null,512)),[[y,Ja.word]])]),n("td",null,[ja.value!==e.NegativeKeywordID?(o(),d("span",{key:0,class:g(["weight-badge",(t=e.WeightModifier,-1===t?"weight-negative":0===t?"weight-zero":"weight-partial")])},m(e.WeightModifier),3)):f((o(),d("select",{key:1,"onUpdate:modelValue":a[6]||(a[6]=e=>Ja.weightModifier=e),class:"form-control form-control-sm"},[...a[35]||(a[35]=[n("option",{value:-1},"-1.0",-1),n("option",{value:0},"0.0",-1),n("option",{value:-.5},"-0.5",-1)])],512)),[[h,Ja.weightModifier]])]),n("td",me,[ja.value!==e.NegativeKeywordID?(o(),d("span",we,m(e.Description||"-"),1)):f((o(),d("input",{key:1,"onUpdate:modelValue":a[7]||(a[7]=e=>Ja.description=e),class:"form-control form-control-sm"},null,512)),[[y,Ja.description]])]),n("td",fe,[n("button",{class:g(["status-toggle",{active:e.IsActive}]),onClick:a=>(async e=>{try{const a=await $.post(`/negativekeywords/toggle/${e.NegativeKeywordID}`);a.data.ok&&(e.IsActive=a.data.data.isActive?1:0,ms(a.data.message,"success"),es())}catch(a){ms(a.response?.data?.message||a.message,"error")}})(e),title:e.IsActive?"คลิกเพื่อปิดใช้งาน":"คลิกเพื่อเปิดใช้งาน"},m(e.IsActive?"ใช้งาน":"ปิด"),11,ye)]),n("td",he,[n("div",ke,[ja.value!==e.NegativeKeywordID?(o(),d(k,{key:0},[n("button",{class:"btn-icon btn-edit",onClick:a=>(e=>{ja.value=e.NegativeKeywordID,Ja.word=e.Word,Ja.weightModifier=e.WeightModifier,Ja.description=e.Description||""})(e),title:"แก้ไข"},[...a[36]||(a[36]=[n("i",{class:"bi bi-pencil"},null,-1)])],8,xe),n("button",{class:"btn-icon btn-delete",onClick:a=>(e=>{Ra.keyword=e,Ra.show=!0})(e),title:"ลบ"},[...a[37]||(a[37]=[n("i",{class:"bi bi-trash"},null,-1)])],8,Ie)],64)):(o(),d(k,{key:1},[n("button",{class:"btn-icon btn-save",onClick:a=>(async e=>{try{const a=await $.put(`/negativekeywords/${e.NegativeKeywordID}`,{word:Ja.word,weightModifier:Ja.weightModifier,description:Ja.description});a.data.ok&&(ms(a.data.message,"success"),ja.value=null,es())}catch(a){ms(a.response?.data?.message||a.message,"error")}})(e),title:"บันทึก"},[...a[38]||(a[38]=[n("i",{class:"bi bi-check-lg"},null,-1)])],8,Me),n("button",{class:"btn-icon btn-cancel",onClick:ss,title:"ยกเลิก"},[...a[39]||(a[39]=[n("i",{class:"bi bi-x-lg"},null,-1)])])],64))])])],4);var t}),128))])])]),Aa.value.totalPages>1?(o(),d("div",Ce,[n("button",{class:"page-btn",disabled:Aa.value.page<=1,onClick:a[8]||(a[8]=e=>gs(Aa.value.page-1))},[...a[41]||(a[41]=[n("i",{class:"bi bi-chevron-left"},null,-1)])],8,Le),n("span",$e," หน้า "+m(Aa.value.page)+" จาก "+m(Aa.value.totalPages),1),n("button",{class:"page-btn",disabled:Aa.value.page>=Aa.value.totalPages,onClick:a[9]||(a[9]=e=>gs(Aa.value.page+1))},[...a[42]||(a[42]=[n("i",{class:"bi bi-chevron-right"},null,-1)])],8,De)])):r("",!0)]),a[70]||(a[70]=v('<div class="info-card slide-in-up" style="animation-delay:0.3s;" data-v-44fc0e2b><h3 class="info-title" data-v-44fc0e2b><i class="bi bi-info-circle me-2" data-v-44fc0e2b></i> วิธีการทำงาน </h3><div class="info-content" data-v-44fc0e2b><p data-v-44fc0e2b><strong data-v-44fc0e2b>คำปฏิเสธ</strong> คือคำที่ใช้บ่งบอกความหมายในเชิงลบหรือยกเว้น</p><p data-v-44fc0e2b>เมื่อ User พิมพ์ <code data-v-44fc0e2b>&quot;ไม่เอาหอใน&quot;</code> ระบบจะ:</p><ol data-v-44fc0e2b><li data-v-44fc0e2b>ตัดคำเป็น: <code data-v-44fc0e2b>[&#39;ไม่&#39;, &#39;เอา&#39;, &#39;หอใน&#39;]</code></li><li data-v-44fc0e2b>พบ Keyword <code data-v-44fc0e2b>&quot;หอใน&quot;</code> (คะแนนปกติ 0.95)</li><li data-v-44fc0e2b>ตรวจสอบย้อนหลัง → พบ <code data-v-44fc0e2b>&quot;ไม่&quot;</code> (ตัวคูณ -1.0)</li><li data-v-44fc0e2b>คะแนนสุดท้าย: <code data-v-44fc0e2b>0.95 × -1.0 = -0.95</code></li></ol><p class="text-muted mt-3" data-v-44fc0e2b>ผลลัพธ์: เอกสารเกี่ยวกับ &quot;หอใน&quot; จะถูกผลักไปท้ายสุดหรือไม่แสดง</p></div></div>',1)),(o(),b(I,{to:"body"},[Qa.show?(o(),d("div",qe,[n("div",{class:g(["toast-message",Qa.type])},[n("i",{class:g(Xa.value)},null,2),n("span",null,m(Qa.message),1)],2)])):r("",!0)])),(o(),b(I,{to:"body"},[Ra.show?(o(),d("div",{key:0,class:"modal-overlay",onClick:a[11]||(a[11]=p(e=>Ra.show=!1,["self"]))},[n("div",Ae,[a[45]||(a[45]=n("div",{class:"modal-icon danger"},[n("i",{class:"bi bi-exclamation-triangle"})],-1)),a[46]||(a[46]=n("h3",{class:"modal-title"},"ยืนยันการลบ",-1)),n("p",Ke,[a[43]||(a[43]=w(' คุณต้องการลบคำปฏิเสธ "',-1)),n("strong",null,m(Ra.keyword?.Word),1),a[44]||(a[44]=w('" ใช่หรือไม่? ',-1))]),n("div",Ne,[n("button",{class:"btn-secondary",onClick:a[10]||(a[10]=e=>Ra.show=!1)},"ยกเลิก"),n("button",{class:"btn-danger",onClick:ps,disabled:Wa.value},m(Wa.value?"กำลังลบ...":"ลบ"),9,Se)])])])):r("",!0)])),(o(),b(I,{to:"body"},[Oa.show?(o(),d("div",{key:0,class:"modal-overlay",onClick:a[13]||(a[13]=p(e=>Oa.show=!1,["self"]))},[n("div",We,[a[52]||(a[52]=n("div",{class:"modal-icon primary"},[n("i",{class:"bi bi-magic"})],-1)),a[53]||(a[53]=n("h3",{class:"modal-title"},"เติมคำอัตโนมัติ",-1)),Oa.loading?(o(),d("div",Ve,[...a[47]||(a[47]=[n("div",{class:"loading-spinner"},null,-1),n("p",{class:"text-muted mt-2"},"กำลังโหลดรายการ...",-1)])])):(o(),d("div",je,[Oa.toAdd.length>0?(o(),d("div",Be,[n("h4",Ue,[a[48]||(a[48]=n("i",{class:"bi bi-plus-circle me-2"},null,-1)),w(" คำที่จะเพิ่มใหม่ ("+m(Oa.toAdd.length)+" คำ) ",1)]),n("div",Ee,[(o(!0),d(k,null,x(Oa.toAdd,e=>(o(),d("span",{key:e.word,class:"seed-word-tag new"},[w(m(e.word)+" ",1),n("small",Te,"("+m(e.modifier)+")",1)]))),128))])])):r("",!0),Oa.alreadyExists.length>0?(o(),d("div",Oe,[n("h4",ze,[a[49]||(a[49]=n("i",{class:"bi bi-check-circle me-2"},null,-1)),w(" มีในระบบแล้ว ("+m(Oa.alreadyExists.length)+" คำ) ",1)]),n("div",Pe,[(o(!0),d(k,null,x(Oa.alreadyExists,e=>(o(),d("span",{key:e.word,class:"seed-word-tag exists"},m(e.word),1))),128))])])):r("",!0),Oa.ignored.length>0?(o(),d("div",_e,[n("h4",He,[a[50]||(a[50]=n("i",{class:"bi bi-eye-slash me-2"},null,-1)),w(" ถูกลบไปแล้ว - จะไม่เพิ่มกลับ ("+m(Oa.ignored.length)+" คำ) ",1)]),n("div",Fe,[(o(!0),d(k,null,x(Oa.ignored,e=>(o(),d("span",{key:e.word,class:"seed-word-tag ignored"},m(e.word),1))),128))])])):r("",!0),0===Oa.toAdd.length?(o(),d("div",Ge,[...a[51]||(a[51]=[n("i",{class:"bi bi-check-circle-fill text-success",style:{"font-size":"2rem"}},null,-1),n("p",{class:"mt-2 mb-0"},"ข้อมูลครบถ้วนแล้ว ไม่มีคำใหม่ที่ต้องเพิ่ม",-1)])])):r("",!0)])),n("div",Je,[n("button",{class:"btn-secondary",onClick:a[12]||(a[12]=e=>Oa.show=!1)},"ยกเลิก"),n("button",{class:"btn-primary-apple",onClick:ls,disabled:Va.value||0===Oa.toAdd.length},m(Va.value?"กำลังเติม...":`เพิ่ม ${Oa.toAdd.length} คำ`),9,Re)])])])):r("",!0)])),(o(),b(I,{to:"body"},[za.show?(o(),d("div",{key:0,class:"modal-overlay recently-deleted-overlay",onClick:a[15]||(a[15]=p(e=>za.show=!1,["self"]))},[n("div",Qe,[n("div",Xe,[n("div",Ye,[n("button",{class:"rd-close-btn",onClick:a[14]||(a[14]=e=>za.show=!1)},[...a[54]||(a[54]=[n("i",{class:"bi bi-chevron-left"},null,-1),n("span",null,"กลับ",-1)])])]),a[55]||(a[55]=n("h3",{class:"rd-title"},"ลบล่าสุด",-1)),n("div",Ze,[za.items.length>0?(o(),d("button",{key:0,class:"rd-action-btn select-btn",onClick:os},m(za.selectMode?"เสร็จ":"เลือก"),1)):r("",!0)])]),za.items.length>0?(o(),d("div",ea,[...a[56]||(a[56]=[n("i",{class:"bi bi-info-circle"},null,-1),n("span",null,"คำที่ลบจะถูกเก็บไว้ที่นี่ คุณสามารถกู้คืนได้ตลอดเวลา",-1)])])):r("",!0),n("div",aa,[_a.value?(o(),d("div",sa,[...a[57]||(a[57]=[n("div",{class:"loading-spinner"},null,-1),n("p",null,"กำลังโหลด...",-1)])])):0===za.items.length?(o(),d("div",ta,[...a[58]||(a[58]=[n("div",{class:"rd-empty-icon"},[n("i",{class:"bi bi-trash3"})],-1),n("h4",null,"ไม่มีคำที่ลบล่าสุด",-1),n("p",null,"คำที่คุณลบจะปรากฏที่นี่",-1)])])):(o(),d("div",la,[(o(!0),d(k,null,x(za.items,e=>(o(),d("div",{key:e.Id,class:g(["rd-item",{selected:za.selectedIds.includes(e.Id)}]),onClick:a=>za.selectMode?(e=>{const a=za.selectedIds.indexOf(e);a>-1?za.selectedIds.splice(a,1):za.selectedIds.push(e)})(e.Id):null},[za.selectMode?(o(),d("div",da,[n("i",{class:g(za.selectedIds.includes(e.Id)?"bi bi-check-circle-fill":"bi bi-circle")},null,2)])):r("",!0),n("div",oa,[n("span",ca,m(e.Word),1),n("span",ra,m(cs(e.DeletedAt)),1)]),za.selectMode?r("",!0):(o(),d("div",na,[n("button",{class:"rd-restore-btn",onClick:p(a=>(async e=>{try{const a=await $.post(`/negativekeywords/restore/${e.Id}`);a.data&&a.data.ok?(ms(`กู้คืน "${e.Word}" สำเร็จ`,"success"),za.items=za.items.filter(a=>a.Id!==e.Id),Pa.value=Math.max(0,Pa.value-1),await es()):ms(a.data?.message||"ไม่สามารถกู้คืนได้","error")}catch(a){ms(a.response?.data?.message||"เกิดข้อผิดพลาด","error")}})(e),["stop"]),title:"กู้คืน"},[...a[59]||(a[59]=[n("i",{class:"bi bi-arrow-counterclockwise"},null,-1)])],8,ua),n("button",{class:"rd-delete-btn",onClick:p(a=>(async e=>{if(confirm(`ลบ "${e.Word}" ถาวร? ไม่สามารถกู้คืนได้อีก`))try{const a=await $.delete(`/negativekeywords/deleted/${e.Id}`);a.data&&a.data.ok?(ms(`ลบ "${e.Word}" ถาวรแล้ว`,"success"),za.items=za.items.filter(a=>a.Id!==e.Id),Pa.value=Math.max(0,Pa.value-1)):ms(a.data?.message||"ไม่สามารถลบได้","error")}catch(a){ms(a.response?.data?.message||"เกิดข้อผิดพลาด","error")}})(e),["stop"]),title:"ลบถาวร"},[...a[60]||(a[60]=[n("i",{class:"bi bi-trash3-fill"},null,-1)])],8,va)]))],10,ia))),128))]))]),za.selectMode&&za.items.length>0?(o(),d("div",ba,[n("button",{class:"rd-footer-btn restore",disabled:0===za.selectedIds.length,onClick:rs},[a[61]||(a[61]=n("i",{class:"bi bi-arrow-counterclockwise"},null,-1)),n("span",null,"กู้คืน "+m(za.selectedIds.length>0?`(${za.selectedIds.length})`:""),1)],8,pa),n("button",{class:"rd-footer-btn delete",disabled:0===za.selectedIds.length,onClick:ns},[a[62]||(a[62]=n("i",{class:"bi bi-trash3-fill"},null,-1)),n("span",null,"ลบถาวร "+m(za.selectedIds.length>0?`(${za.selectedIds.length})`:""),1)],8,ga)])):r("",!0),!za.selectMode&&za.items.length>0?(o(),d("div",ma,[n("button",{class:"rd-footer-btn restore-all",onClick:us},[...a[63]||(a[63]=[n("i",{class:"bi bi-arrow-counterclockwise"},null,-1),n("span",null,"กู้คืนทั้งหมด",-1)])]),n("button",{class:"rd-footer-btn delete-all",onClick:vs},[...a[64]||(a[64]=[n("i",{class:"bi bi-trash3-fill"},null,-1),n("span",null,"ลบทั้งหมด",-1)])])])):r("",!0)])])):r("",!0)])),(o(),b(I,{to:"body"},[Fa.show?(o(),d("div",{key:0,class:"modal-overlay",onClick:a[17]||(a[17]=p(e=>Fa.show=!1,["self"]))},[n("div",wa,[a[67]||(a[67]=n("div",{class:"modal-icon danger"},[n("i",{class:"bi bi-exclamation-triangle"})],-1)),a[68]||(a[68]=n("h3",{class:"modal-title"},"ลบถาวรทั้งหมด?",-1)),n("p",fa,[w(" คำทั้งหมด "+m(za.items.length)+" คำจะถูกลบถาวร",1),a[65]||(a[65]=n("br",null,null,-1)),a[66]||(a[66]=n("strong",{class:"text-danger"},"ไม่สามารถกู้คืนได้อีก",-1))]),n("div",ya,[n("button",{class:"btn-secondary",onClick:a[16]||(a[16]=e=>Fa.show=!1)},"ยกเลิก"),n("button",{class:"btn-danger",onClick:bs,disabled:Ha.value},m(Ha.value?"กำลังลบ...":"ลบถาวรทั้งหมด"),9,ha)])])])):r("",!0)]))])])]))}},[["__scopeId","data-v-44fc0e2b"]]);export{ka as default};
